[
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi1/",
	"title": "Archi1",
	"tags": [],
	"description": "",
	"content": "Archi 1 Objectif Cette documentation permet de reproduire l\u0026rsquo;architecture de référence pour la mise en place de la collecte et l\u0026rsquo;intégration automatique de marqueurs/IOC dans des équipements de sécurité et l\u0026rsquo;infrastructure, sur un mini réseau d\u0026rsquo;entreprise.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/",
	"title": "README",
	"tags": [],
	"description": "",
	"content": " Ceci est une démonstration utilisant un DM6 provenant de SRS 2020.\n Le saviez-vous ? D\u0026rsquo;après une étude réalisée en 2020 sur un échantillion de 25 personnes, la promotion SRS 2020 serait la meilleure.\n Les références vers les images ne sont pas encore compatibles avec la démo.\n README en construction\n  "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi2/",
	"title": "Archi2",
	"tags": [],
	"description": "",
	"content": "Archi 2 Objectif Cette documentation permet de reproduire l\u0026rsquo;architecture permettant de réaliser des scans réseau sur l\u0026rsquo;architecture mise en plcace via la documentation archi1.pdf.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/questions_r%C3%A9ponses/questions/",
	"title": "Découvertes des réseaux",
	"tags": [],
	"description": "",
	"content": "Comment le logiciel identifie-t-il le type de matériel suite à au moins une écoute passive du réseau ? Le logiciel peut capturer des paquets contenant l\u0026rsquo;adresse MAC des machines et ainsi en récupérer des informations comme par exemple le constructeur ou le type d\u0026rsquo;appareil.\nComment le logiciel identifie-t-il le système d\u0026rsquo;exploitation ? Le logiciel identifie le type de système d\u0026rsquo;exploitation grâce à une empreinte de la pile TCP/IP de la machine ciblée.\nAinsi, après avoir envoyé des paquets TCP/IP à la machine cible, l\u0026rsquo;analyse des réponses de la machine scannée permet (ou non) d\u0026rsquo;identifier un système d\u0026rsquo;exploitation.\nComment le logiciel identifie-t-il les services exposés ? Pour Nmap, une fois que les ports TCP et/ou UDP ont été découverts grâce à l\u0026rsquo;une des méthodes de scan, la détection de version interroge ces ports-là pour en savoir plus sur le type de service qui tourne dessus. La base de données nmap-service-probes contient des sondes pour interroger de multiples services, et comparer les expressions pour reconnaître les réponses et les analyser. Nmap essaye de déterminer le protocole du service, le nom de l\u0026rsquo;application, le numéro de version, le nom d\u0026rsquo;hôte, le type de périphérique, et la famille du système d\u0026rsquo;exploitation.\nLorsque des services RPC ont été mis en évidence, le module RPC de Nmap est utilisé pour déterminer le programme RPC et les numéros de version. Il prend tous les ports TCP/UDP détectés comme étant du RPC, et les inonde avec des commandes NULL du programme SunRPC, pour tenter de déterminer s\u0026rsquo;il s\u0026rsquo;agit bien de ports RPC, et si oui, de déterminer quel programme et quel numéro de version ils servent.\nLorsque Nmap reçoit des réponses d\u0026rsquo;un service mais qu\u0026rsquo;il ne peut pas les faire correspondre à sa base de données, il affiche une empreinte spéciale ainsi qu\u0026rsquo;une URL à laquelle il est possible de soumettre ce qui s\u0026rsquo;exécute sur ce port ; mais cela uniquement si l\u0026rsquo;on est certain de ce qui s\u0026rsquo;exécute.\nQu\u0026rsquo;est-ce qu\u0026rsquo;un script NSE ? Les scripts NSE permettent aux utilisateurs d\u0026rsquo;automatiser un certain nombre de tâches liées au réseau.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/microsoft/microsoft/",
	"title": "Déroulé d&#39;une analyse avec MBSA",
	"tags": [],
	"description": "",
	"content": "Présentation générale de l\u0026rsquo;utilisation de MBSA Tout d\u0026rsquo;abord, MBSA doit être exécuté avec un compte à privilèges. En effet, un simple utilisateur du domaine n\u0026rsquo;a pas le droit d\u0026rsquo;exécuter ce logiciel :\n{#11}\nEnsuite, MBSA peut être utilisé de deux manières :\n  Via l\u0026rsquo;interface graphique : mbsa.exe\n  Via l\u0026rsquo;invite de commande : mbsacli.exe\n  L\u0026rsquo;analyse peut être réalisée sur une seule machine ou bien sur plusieurs. L\u0026rsquo;analyse sur une machine est traitée dans la suite de ce document. L\u0026rsquo;analyse de plusieurs machines d\u0026rsquo;un parc est traitée dans le document microsoft-annexe.pdf.\nAinsi, pour analyser une machine avec MBSA, il faut donner le nom de la machine à analyser, ou bien son adresse IPv4. Il faut également sélectionner les options qui seront utilisées pour l\u0026rsquo;analyse.\nUne fois l\u0026rsquo;analyse terminée, MBSA génère un rapport au format XML. Ces rapports sont stockés dans le dossier suivant : C:\\Users\\\u0026lt;nom_utilisateur\u0026gt;\\SecurityScans.\nExécution de MBSA en local sur PC01 Le PC01 est une machine sous Windows 8.1, sur laquelle MBSA 2.3 a été installé.\nUtilisation de MBSA par son interface graphique Ouvrir le logiciel MBSA en double-cliquant sur le raccourci créé à l\u0026rsquo;installation sur le bureau. Cliquer sur Analyser un ordinateur :\n{#Screenshots/Win8-local/1}\nChoisir l\u0026rsquo;ordinateur à analyser, soit en donnant son nom, soit en donnant son adresse IPv4. Ici, c\u0026rsquo;est la machine PC01 du domaine EPITAF (EPITAF\\PC01). Il faut également sélectionner les options pour l\u0026rsquo;analyse MBSA.\nPour le scan de la capture d\u0026rsquo;écran ci-dessous, nous avons choisi de garder toutes les options, c\u0026rsquo;est-à-dire que l\u0026rsquo;analyse va porter sur :\n  les vulnérabilités d\u0026rsquo;administration de Windows ;\n  les mots de passe vulnérables ;\n  les vulnérabilités d\u0026rsquo;administration de IIS ;\n  les vulnérabilités de SQL ;\n  les mises à jour de sécurité.\n  Cliquer sur Démarrer l\u0026rsquo;analyse :\n{#Screenshots/Win8-local/2}\nPatienter pendant l\u0026rsquo;analyse MSBA\n{#Screenshots/Win8-local/3}\nUne fois l\u0026rsquo;analyse terminée, le rapport est affiché. Il indique le niveau de sécurité, soit Risque important selon la capture d\u0026rsquo;écran suivante. Les résultats portent sur de multiples catégories :\n{#Screenshots/Win8-local/4}\nAinsi, on peut voir que le PC01 n\u0026rsquo;a pas toutes les mises à jour de sécurité installées. En regardant dans les Détails de cette catégorie, MBSA liste les mises à jour de sécurité manquantes, ainsi que celles qui sont bien installées, dans les figures 9{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Win8-local/6\u0026rdquo;} et 10{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Win8-local/7\u0026rdquo;}.\\\nÉgalement, cet ordinateur possède une vulnérabilité d\u0026rsquo;administration, concernant des mots de passe qui n\u0026rsquo;expirent jamais. En cliquant sur Détails du résultat pour cette vulnérabilité, on obtient :\n{#Screenshots/Rapport/9}\nPour la catégorie de vulnérabilité Test des mots de passe des comptes locaux, la fenêtre de détails est la suivante (obtenue en cliquant sur Détails) :\n{#Screenshots/Rapport/10}\nLa figure ci-dessous est la suite du rapport de l\u0026rsquo;analyse MBSA pour PC01.\n{#Screenshots/Win8-local/5}\nMBSA permet aussi d\u0026rsquo;obtenir des informations système supplémentaires, portant notamment sur l\u0026rsquo;audit, les services, les partages, ou encore la version de Windows. Aussi, les services IIS et SQL Server n\u0026rsquo;étant pas activés sur cette machine, MBSA informe seulement qu\u0026rsquo;ils ne sont pas activés sur cet ordinateur.\nSur certains résultats de l\u0026rsquo;analyse, il est possible d\u0026rsquo;accéder à des détails. Sur la figure 9{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Win8-local/6\u0026rdquo;}, ce sont les détails concernant les mises à jour de sécurité. Cette partie du rapport permet de donner les ID des éléments qui ne sont pas présents sur le système, telle que la mise à jour MS13-098 :\n{#Screenshots/Win8-local/6}\nLa capture d\u0026rsquo;écran suivante (/Microsoft/10{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Win8-local/7\u0026rdquo;}) est la suite de la figure précédente (/Microsoft/9{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Win8-local/6\u0026rdquo;}), et montre les mises à jour qui sont actuellement présentes sur le système :\n{#Screenshots/Win8-local/7}\nUtilisation de MBSA par invite de commande L\u0026rsquo;analyse d\u0026rsquo;une machine par Microsoft Baseline Security Analyzer peut également se faire en utilisant une invite de commande. Pour cela, il faut ouvrir une invite de commande en ayant les droits suffisants. Ensuite, la commande permettant d\u0026rsquo;effectuer une analyse équivalente à celle présentée précédemment est la suivante : mbsacli.exe /target EPITAF\\PC01 /n OS+IIS+SQL+PASSWORD{.powershell}.\nL\u0026rsquo;exécution de cette commande est montrée sur la figure ci-dessous :\n{#Screenshots/Win8-local/8}\nCe rapport est également stocké sous format XML. Le fichier est situé dans le dossier doc/scan/MBSA/Local-PC01.\nExécution de MSBA en local sur DC01 Le DC01 est une machine sous Windows Server 2012, qui est un contrôleur domaine, et sur lequel MBSA 2.1 a été installé.\nL\u0026rsquo;utilisation de MBSA se fait de la même manière sur Windows Server 2012 que sur Windows 8.1. La démarche reste la même : utilisation du nom de la machine à analyser (ici, EPITAF\\DC01), et sélection des options à analyser.\nSur la machine Windows Server 2012 (DC01), ouvrir le logiciel MBSA. Tout comme sur la machine Windows 8.1 (PC01), sélectionner le périmètre sur lequel l\u0026rsquo;analyse MBSA va porter. Ici, l\u0026rsquo;on choisit d\u0026rsquo;analyser un ordinateur.\n{#Screenshots/WS-local/0}\nL\u0026rsquo;analyse porte ici sur la machine Windows Server 2012. Le nom de l\u0026rsquo;ordinateur est donc EPITAF\\DC01. Il faut également sélectionner les options pour l\u0026rsquo;analyse MBSA. Ces options sont les mêmes que pour l\u0026rsquo;analyse sur PC01. Cliquer sur Démarrer l\u0026rsquo;analyse :\n{#Screenshots/WS-local/1}\nPatienter pendant l\u0026rsquo;analyse MSBA :\n{#Screenshots/WS-local/2}\nCi-dessous, le rapport obtenu après analyse du DC01, sous forme de captures d\u0026rsquo;écran :\n{#Screenshots/WS-local/3}\n{#Screenshots/WS-local/4}\n{#Screenshots/WS-local/5}\nDe la même manière que pour PC01, le DC01 ne possède pas toutes les mises à jour de sécurité. En effet, le rapport indique que 91 mises à jour de sécurité sont absentes, de même que 10 Service Packs ou correctifs cumulatifs (figure 15{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/WS-local/3\u0026rdquo;}).\nEn cliquant sur Détails pour la catégorie des mises à jour, MBSA liste toutes les mises à jour de sécurité qui ne sont pas installées et qui devraient l\u0026rsquo;être :\n{#Screenshots/Rapport/11}\n{#Screenshots/Rapport/12}\n{#Screenshots/Rapport/13}\n{#Screenshots/Rapport/14}\nDe plus, du point de vue de l\u0026rsquo;analyse Windows, il existe plusieurs vulnérabilités d\u0026rsquo;administration, dont notamment :\n  Le service de mise à jour automatique qui n\u0026rsquo;est pas configuré pour être lancé automatiquement ;\n  Présence de plus de deux administrateurs sur cet ordinateur ;\n  Deux comptes d\u0026rsquo;utilisateurs possèdent un mot de passe qui n\u0026rsquo;expire jamais, tout comme pour PC01.\n  Contrairement au PC01, les services Internet IIS sont activés sur le DC01. C\u0026rsquo;est pour cela que certaines vulnérabilités sont listées dans la catégorie Résultats de l\u0026rsquo;analyse des services Internet IIS - Vulnérabilités d\u0026rsquo;administration (figure 16{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/WS-local/4\u0026rdquo;}).\nDe même, SQL Server est installé sur le DC01, d\u0026rsquo;où la présence d\u0026rsquo;une liste de vulnérabilités dans la catégorie Résultats de l\u0026rsquo;analyse de SQL Server - Vulnérabilités d\u0026rsquo;administration (figure 17{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/WS-local/5\u0026rdquo;}).\nCe rapport est également stocké sous format XML. Le fichier est situé dans le dossier doc/scan/MBSA/Local-DC01.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/dev/environnement/",
	"title": "Environnement",
	"tags": [],
	"description": "",
	"content": "Architecture des sources Le fichier mini-pki.ps1 est le script PowerShell permettant de créer une PKI. Il contient tout ce qui est nécessaire à :\n  La création d\u0026rsquo;un certificat de la root CA\n  La création utilisateur de certificat de chiffrement ou de signature\n  La création et la mise à jour de la CRL\n  La création du certificat nécessaire au serveur OCSP.\n  Modules Afin de mettre en œuvre une PKI, nous avons utilisé l\u0026rsquo;utilitaire cryptographique OpenSSL. Cette boîte à outils permet en effet de générer des certificats, les signer, les révoquer ou encore lancer un serveur OCSP. Il faut ainsi installer OpenSSL sur les machines Windows de notre domaine.\\\nTéléchargement et installation d\u0026rsquo;OpenSSL La première étape consiste à télécharger l\u0026rsquo;exécutable permettant d\u0026rsquo;installer OpenSSL. Il faut tout d\u0026rsquo;abord se rendre sur la page wiki d\u0026rsquo;OpenSSL, pour savoir où télécharger l\u0026rsquo;exécutable. Il faut pour cela se rendre à l\u0026rsquo;url suivante : https://wiki.openssl.org/index.php/Binaries. Sur le tableau - montré sur la figure ci-dessous - cliquer sur le lien encadré en rouge sur la figure :\nCliquer sur le bouton EXE de la cellule Win64 OpenSSL v1.1.1b - prendre la plus récente version :\nCliquer sur Oui dans la fenêtre \u0026quot;Setup\u0026quot; :\nCliquer sur Enregistrer le fichier :\nCocher \u0026quot;J\u0026rsquo;accepte les conditions générales de la licence\u0026quot;, puis cliquer sur Installer :\nCliquer sur Fermer :\nCocher \u0026quot;I accept the agreement\u0026quot;, puis cliquer sur Next :\nCliquer sur Next :\nCliquer sur Next :\nCocher l\u0026rsquo;option \u0026quot;The OpenSSL binaries (/bin) directory\u0026quot; puis cliquer sur Next :\nCliquer sur Install :\nDécocher toutes les options, puis cliquer sur Finish :\nConfiguration d\u0026rsquo;OpenSSL Ouvrir le panneau de configuration, aller dans la section Système et sécurité, puis aller dans Système. Cliquer sur \u0026quot;Paramètres système avancés\u0026quot; :\nAller dans l\u0026rsquo;onglet \u0026quot;Paramètres système avancés\u0026quot; et cliquer sur Variables d\u0026rsquo;environnement... :\nSélectionner la ligne de la variable Path, puis cliquer sur Modifier :\nAjouter \u0026quot;;C:\\Program Files\\OpenSSL-Win64\\bin\u0026quot; à la valeur de la variable, puis cliquer sur Ok :\nCliquer sur Ok :\nCliquer sur Ok :\nExécution du script Afin de récupérer les scripts PowerShell sur les machines virtuelles, il est possible d\u0026rsquo;utiliser la fonctionnalité de partage de fichiers de VirtualBox. Il est alors possible de partager un dossier présent sur la machine hôte avec la machine virtuelle. Les deux sections suivantes déroulent la procédure d\u0026rsquo;installation.\nInstaller Additions Invité Allumer l\u0026rsquo;une des deux machines virtuelles Windows et s\u0026rsquo;y connecter. Dans l\u0026rsquo;onglet Périphériques, choisir \u0026quot;Installer l\u0026rsquo;image CD des Additions invité...\u0026quot; :\nOuvrir le gestionnaire de fichiers, et aller dans la section Ce PC. Double cliquer sur l\u0026rsquo;icône VirtualBox :\nL\u0026rsquo;exécutable se met en route. Cliquer sur Suivant :\nCliquer sur Suivant :\nCliquer sur Suivant :\nAttendre la fin de l\u0026rsquo;installation des Additions invité :\nSélectionner l\u0026rsquo;option Redémarrer maintenant et cliquer sur Terminer :\nSi l\u0026rsquo;icône des Additions invité n\u0026rsquo;est pas un exécutable mais un dossier, aller dans le dossier puis double cliquer sur l\u0026rsquo;exécutable sélectionné sur la figure suivante :\nEnsuite, cliquer sur Oui sur la fenêtre générée :\nEnfin, suivre la procédure telle que décrite précédemment et redémarrer la machine.\nConfigurer le partage de fichiers Une fois la machine redémarrée, aller dans Périphériques, puis Dossiers partagés. Cliquer sur Réglages des dossiers partagés :\nAller dans la section Dossiers partagés. Sélectionner la ligne Dossiers permanents, puis cliquer sur l\u0026rsquo;icône de dossier avec le plus :\nDonner le chemin du dossier à partager ; cocher Montage automatique et Configuration permanente. Cliquer sur OK :\nCliquer sur OK :\nRedémarrer la machine virtuelle.\nLorsque la machine a redémarré, ouvrir le gestionnaire de fichiers. Le disque réseau est créé, et contient les fichiers partagés entre la machine hôte et la machine virtuelle :\nExécution du script Par défaut, la police d\u0026rsquo;exécution Windows est en mode Restricted, cela signifie qu\u0026rsquo;il n\u0026rsquo;est pas possible d\u0026rsquo;exécuter un script PowerShell. Ainsi, afin d\u0026rsquo;avoir la possibilité d\u0026rsquo;exécuter le script, il faut contourner la police d\u0026rsquo;exécution. La solution choisie est de lancer le script avec la commande suivante :\npowershell -ExecutionPolicy Bypass .\\mini-pki.ps1 \u0026lt;arguments...\u0026gt; Il n\u0026rsquo;y a alors pas besoin d\u0026rsquo;utiliser la commande Set-ExecutionPolicy{.powershell} pour changer le mode afin d\u0026rsquo;exécuter le script, puis de le remettre en Restricted.\nÉgalement, les fichiers de configuration openssl-ca.cnf et openssl-user.cnf doivent se situer dans le même dossier que le script mini-pki.ps1. De plus, il ne faut pas lancer le script mini-pki.ps1 dans le dossier partagé. En effet, le champ \u0026lsquo;nsRevocationUrl\u0026rsquo; nous oblige à mettre les trois fichiers openssl-ca.cnf, openssl-user.cnf et mini-pki.ps1, dans le dossier C:\\User\\admin, et lancer le script dans celui-ci.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/microsoft_annexe/microsoft_annexe/",
	"title": "Exécution d&#39;un déploiement de MBSA",
	"tags": [],
	"description": "",
	"content": "Présentation Microsoft Baseline Security Analyzer offre la possibilité d\u0026rsquo;effectuer une analyse sur un ensemble de machines. Cet ensemble peut être défini selon deux manières :\n  Sur un domaine\n  Sur une plage d\u0026rsquo;adresses IPv4\n  Cependant, afin que les machines de l\u0026rsquo;ensemble à analyser puissent être examinées, il faut tout d\u0026rsquo;abord faire certaines configurations, autant sur le contrôleur de domaine duquel l\u0026rsquo;analyse sera lancée que sur les machines qui seront analysées.\\\nConfigurations requises Configurations sur Windows Server 2012 Afin que MBSA puisse analyser les machines autres que celle à partir de laquelle le scan est lancé, il faut que le service Remote Registry (ou Registre à distance) soit démarré. Ainsi, pour le démarrer sur toutes les machines, il est possible de créer une GPO.\nPour cela, il faut ouvrir le gestionnaire des stratégies de groupe :\n{#Screenshots/Config/1}\nDérouler les Domaines dans l\u0026rsquo;onglet gauche. Cliquer droit sur le domaine EPITAF.local, puis cliquer sur Créer un objet GPO dans ce domaine, et le lier ici... :\n{#Screenshots/Config/2}\nDonner un nom à la nouvelle GPO ; ici Remote Registry. Cliquer sur OK :\n{#Screenshots/Config/3}\nUne fois la nouvelle GPO créée, il faut la configurer. Pour cela, cliquer droit sur la GPO Remote Registry puis cliquer sur Modifier :\n{#Screenshots/Config/4}\nAller dans : Configuration ordinateur \u0026gt; Paramètres Windows \u0026gt; Paramètres de sécurité \u0026gt; Services système. Enfin, rechercher le service Registre à distance dans la liste, puis cliquer droit dessus pour accéder à ses Propriétés :\n{#Screenshots/Config/5}\nSélectionner les mêmes informations que sur la figure suivante, puis cliquer sur OK :\n{#Screenshots/Config/6}\nAu prochain redémarrage des machines du domaine, la GPO prendra effet, et le service Registre à distance sera démarré automatiquement.\\\nMaintenant, il faut configurer le Pare-feu Windows.\nIl faut tout d\u0026rsquo;abord autoriser l\u0026rsquo;application MBSA à communiquer à traver le Pare-feu. Ouvrir le Pare-feu Windows, via la recherche Windows ou via le Panneau de configuration, dans Système et sécurité, puis Pare-feu Windows. Cliquer sur \u0026quot;Autoriser une application ou une fonctionnalité via le Pare-feu Windows\u0026quot;\n{#Screenshots/Config/7}\nCliquer sur Autoriser une autre application :\n{#Screenshots/Config/8}\nSélectionner Microsoft Baseline Security Analyzer 2.1 dans la liste, puis cliquer sur OK :\n{#Screenshots/Config/9}\nVérifier que MBSA est bien autorisé sur le Domaine. Cliquer sur OK :\n{#Screenshots/Config/10}\nSélectionner la fonctionnalité Service Accès réseau en cochant pour le Domaine, puis cliquer sur OK :\n{#Screenshots/Config/11}\nConfigurations sur les machines du domaine Sur la machine Windows 8.1 (PC01), ouvrir le pare-feu Windows, via la recherche Windows ou via le Panneau de configuration, dans Système et sécurité, puis Pare-feu Windows. Cliquer sur \u0026quot;Autoriser une application ou une fonctionnalité via le Pare-feu Windows\u0026quot; :\n{#Screenshots/Config/12}\nCliquer sur Modifier les paramètres :\n{#Screenshots/Config/13}\nEntrer les identifiants d\u0026rsquo;un utilisateur ayant suffisamment de privilèges pour apporter des modifications aux paramètres concernant les applications autorisées à communiquer à travers le Pare-feu Windows, puis cliquer sur Oui :\n{#Screenshots/Config/14}\nSélectionner les deux fonctionnalités suivantes, pour le Domaine : Recherche du réseau et Service Accès réseau. Enfin, cliquer sur OK :\n{#Screenshots/Config/15}\nDéploiement d\u0026rsquo;une analyse MBSA sur le domaine  Pour ce déploiement, le domaine comporte deux machines sous Windows 8.1 PC01 et PC02.\nSur la machine Windows Server 2012 (DC01), ouvrir MBSA. Cliquer sur Analyser plusieurs ordinateurs :  {#Screenshots/Rapport/00}\nDonner le nom du domaine sur lequel exécuter l\u0026rsquo;analyse MBSA, ou bien la plage d\u0026rsquo;adresses IPv4. Sur la figure 17{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Screenshots/Rapport/01\u0026rdquo;}, l\u0026rsquo;analyse est effectuée sur le domaine epitaf. Il faut également sélectionner les options pour l\u0026rsquo;analyse MBSA. Cliquer sur Démarrer l\u0026rsquo;analyse :\n{#Screenshots/Rapport/01}\nPatienter pendant l\u0026rsquo;analyse MSBA :\n{#Screenshots/Rapport/02}\nUne fois l\u0026rsquo;analyse terminée, des rapports sont générés pour chaque machine analysée. Sélectionner en premier le rapport pour la machine DC01, en cliquant dessus :\n{#Screenshots/Rapport/1}\n{#Screenshots/Rapport/2}\n{#Screenshots/Rapport/3}\n{#Screenshots/Rapport/4}\nPour voir le rapport suivant, il faut revenir en arrière en cliquant sur la flèche retour en haut à gauche de la fenêtre, ou bien cliquer sur OK, en bas à droite de la fenêtre. Sélectionner le rapport suivant, concernant la machine PC02 :\n{#Screenshots/Rapport/5}\n{#Screenshots/Rapport/6}\nComme précédemment, revenir à l\u0026rsquo;écran de choix des rapports générés par MBSA, afin de choisir le rapport de la machine PC01 :\n{#Screenshots/Rapport/7}\n{#Screenshots/Rapport/8}\nLes rapports des machines DC01 et PC01 sont les mêmes que ceux générés par leur analyse MBSA locale détaillée expliquée dans le document microsoft.pdf.\nÉgalement, ces rapports sont stockés sous format XML. Les fichiers sont situés dans le dossier doc/scan/MBSA/Scan-parc.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/analyse/partie1/",
	"title": "Partie 1",
	"tags": [],
	"description": "",
	"content": "Synthèse des résultats des scans D\u0026rsquo;après les figures ci-dessous, le système d\u0026rsquo;information cible est un système vieillissant.\nLa figure [PART1/2]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART1/2\u0026rdquo;} indique que toutes les machines sont vulnérables. De plus, le contrôleur de domaine est le plus susceptible d\u0026rsquo;être compromis.\nLe pare-feu et les machines utilisateurs sont les moins vulnérables du système d\u0026rsquo;information.\nUn attaquant ayant accès au LAN pourrait aisément devenir administrateur du domaine Windows.\n[[PART1/1]]{#PART1/1 label=\u0026ldquo;PART1/1\u0026rdquo;}\n[[PART1/2]]{#PART1/2 label=\u0026ldquo;PART1/2\u0026rdquo;}\n[[PART1/3]]{#PART1/3 label=\u0026ldquo;PART1/3\u0026rdquo;}\n[[PART1/4]]{#PART1/4 label=\u0026ldquo;PART1/4\u0026rdquo;}\n[.]{style=\u0026ldquo;color: white\u0026rdquo;}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/analyse/partie2/",
	"title": "Partie 2",
	"tags": [],
	"description": "",
	"content": "Comparaisons des résultats des scans des machines Afin de pouvoir réaliser certains scans de machine, il est important de positionner le paramètre Consider Alive via l\u0026rsquo;option Alive Test lors de la création des profils des machines. La figure [PART2/1]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/1\u0026rdquo;} montre l\u0026rsquo;opération :\n[[PART2/1]]{#PART2/1 label=\u0026ldquo;PART2/1\u0026rdquo;}\nComparaison des scans simple et ultimate Les scans dits Ultimate ont été réalisés avec les données d\u0026rsquo;authentification des machines du parc, contrairement aux scans simples.\nLes scans Ultimate ont une meilleure pénétration, puisqu\u0026rsquo;il est possible de scanner avec des privilèges élevés.\nCela se traduit par un plus grand nombre de vulnérabilités découvertes.\nLes figures [PART2/2]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/2\u0026rdquo;} et [PART2/3]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/3\u0026rdquo;} montrent la différence entre les scans Windows Server :\n[[PART2/2]]{#PART2/2 label=\u0026ldquo;PART2/2\u0026rdquo;}\n[[PART2/3]]{#PART2/3 label=\u0026ldquo;PART2/3\u0026rdquo;}\nLes figures [PART2/4]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/4\u0026rdquo;} et [PART2/5]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/5\u0026rdquo;} montrent la différence entre les scans MISP.\n[[PART2/4]]{#PART2/4 label=\u0026ldquo;PART2/4\u0026rdquo;}\n[[PART2/5]]{#PART2/5 label=\u0026ldquo;PART2/5\u0026rdquo;}\nLa figure [PART2/6]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;PART2/6\u0026rdquo;} montre l\u0026rsquo;analyse d\u0026rsquo;une bibliothèque dynamique sur le disque de Windows Server 2012.\nLa vulnérabilité trouvée n\u0026rsquo;est possible qu\u0026rsquo;avec des droits privilégiés, via l\u0026rsquo;utilisation des secrets fournis dans le scan Ultimate de Windows Server.\n[[PART2/6]]{#PART2/6 label=\u0026ldquo;PART2/6\u0026rdquo;}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi1/perim%C3%A8tre/",
	"title": "Périmètre fonctionnel",
	"tags": [],
	"description": "",
	"content": "Architecture attendue Comme le présentent les figures [Architecture_Screenshots/1]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Architecture_Screenshots/1\u0026rdquo;} et 250{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Schema_tls/1\u0026rdquo;} pour l\u0026rsquo;interception SSL/TLS, une fois la documentation mise en œuvre, il sera obtenu :\n  1 machine virtuelle Windows Server 2012 :\n  Rôle de domaine contrôleur \u0026quot;EPITAF\u0026quot;;\n  Nom de machine : DC01;\n  IP fixe 192.168.2.2, route par défaut 192.168.2.1;\n  Serveur DHCP \u0026ndash; plage distribuable : 192.168.2.10 \u0026ndash; 20.\n    1 machine virtuelle Windows 10 :\n  Membre du domaine \u0026quot;EPITAF\u0026quot;;\n  Nom de machine : PC01;\n  IP par DHCP.\n    1 machine virtuelle Debian :\n  Nom de la machine : INFRA01;\n  IP fixe 1920168.3.2, route par défaut 192.168.3.1z;\n  Toutes les connexions se font sous pfSense.\n    1 machine virtuelle : Virtual appliance (VA) MISP :\n  Nom de machine : SECU01\n  IP fixe 192.168.2.3, route par défaut 192.168.2.1\n  Toutes les connexions à internet se font à travers le PFSense.\n    1 machine virtuelle : Virtual appliance Graylog\n  Nom de machine : SECU02\n  IP fixe 192.168.2.4, route par défaut 192.168.2.1\n  Toutes les connexions à internet se font à travers le PFSense.\n    1 machine virtuelle PFSense :\n  Routeur par défaut du réseau 192.168.2.0/24 et 192.168.3.0/24 ;\n  Interface LAN : IP fixe 192.168.2.1\n Seuls les flux DNS, HTTP et HTTPs sortant sont autorisés depuis 192.168.2.0/24 avec la configuration du DM2.    Interface DMZ : IP fixe 192.168.3.1\n  Seuls les flux DNS, HTTP et HTTPs sortant sont autorisés depuis 192.168.3.0/24 ;\n  Seuls les flux DNS, HTTP/HTTPs et SSH entrant sont autorisés depuis l\u0026rsquo;interface LAN ;\n      [[Architecture_Screenshots/1]]{#Architecture_Screenshots/1 label=\u0026ldquo;Architecture_Screenshots/1\u0026rdquo;}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi2/p%C3%A9rim%C3%A8tre/",
	"title": "Périmètre fonctionnel",
	"tags": [],
	"description": "",
	"content": "Architecture attendue Comme le présentent les figures [Architecture_Screenshots/1]{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Architecture_Screenshots/1\u0026rdquo;}, une fois la documentation mise en œuvre, il sera obtenu en complément de l\u0026rsquo;architecture de la documentation archi1.pdf :\n  1 machine virtuelle : Virtual appliance kali\n  Nom de machine : KALI01\n  IP fixe 192.168.2.21, route par défaut 192.168.2.1\n  Toutes les connexions à internet se font à travers le PFSense.\n    1 machine virtuelle : Windows 8.1\n  Nom de machine : PC02\n  IP par DHCP, route par défaut 192.168.2.1\n  Toutes les connexions à internet se font à travers le PFSense.\n    [[Architecture_Screenshots/1]]{#Architecture_Screenshots/1 label=\u0026ldquo;Architecture_Screenshots/1\u0026rdquo;}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/cartographie/scan_passif/",
	"title": "Scan passif",
	"tags": [],
	"description": "",
	"content": "Découverte du réseau avec netdiscover La figure 1{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Netdiscover0\u0026rdquo;} permet de lancer netdiscover en mode écoute passive :\n{#Netdiscover0}\nIl faut ensuite attendre que du trafic se fasse :\n{#Netdiscover1}\nLa figure 3{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Netdiscover2\u0026rdquo;} montre la capture d\u0026rsquo;un paquet en provenance de 192.168.2.11 :\n{#Netdiscover2}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/cartographie/",
	"title": "Cartographie",
	"tags": [],
	"description": "",
	"content": "Cartographie  Présentation de la construction de la cartographie du système d\u0026rsquo;information\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/dev/d%C3%A9veloppement/",
	"title": "Développement",
	"tags": [],
	"description": "",
	"content": "Fonctions Description des fonctions Create-CA Cette fonction s\u0026rsquo;occupe de la création du certificat de la root CA (Autorité de certification). En premier lieu, il faut créer l\u0026rsquo;arborescence, puis verrouiller l\u0026rsquo;accès au dossier de l\u0026rsquo;AC. Les fichiers d\u0026rsquo;index et de serial sont initialisés. Enfin, on génère le certificat AC à l\u0026rsquo;aide d\u0026rsquo;une clé RSA. Des données spécifiques à l\u0026rsquo;AC sont demandées à l\u0026rsquo;administrateur. Ce certificat est un tiers de confiance permettant d\u0026rsquo;identifier l\u0026rsquo;identité des correspondants.\nUser-req Cette fonction s\u0026rsquo;occupe de générer les clés privée et publique de l\u0026rsquo;utilisateur en paramètre. Ensuite, on établit la demande de signature de certificat (CSR) à l\u0026rsquo;aide de cette clé. Le but sera de l\u0026rsquo;adresser à l\u0026rsquo;AC afin d\u0026rsquo;obtenir un certificat numérique signé. Encore une fois, il est demandé, cette fois-ci à l\u0026rsquo;utilisateur, de saisir les informations qui lui sont propres.\nUser-sign Cette fonction s\u0026rsquo;occupe simplement de soumettre la demande de signature (CSR) à l\u0026rsquo;autorité de certification. Afin d\u0026rsquo;être validé, le certificat devra respecter une police stricte, par exemple avoir le même pays ou nom d\u0026rsquo;organisation. En cas de succès et de confirmation par l\u0026rsquo;utilisateur, un certificat signé par l\u0026rsquo;AC est émis.\nRevoke Cette fonction révoque le certificat donné en paramètre en l\u0026rsquo;inscrivant dans la base de données correspondant à la liste de révocation de certificats (CRL). Ce certificat sera par la suite refusé même s\u0026rsquo;il est toujours en cours de validité.\nGenCRL Cette fonction génère un fichier, à partir de la base de données correspondante, qui est la CRL et qui comprend tous les certificats révoqués.\nGenOCSP Cette fonction réalise deux actions : demande de création d\u0026rsquo;un certificat pour le serveur OCSP, et génération du certificat par la root CA.\nPour la première action, on fait une requête CSR. La commande utilise l\u0026rsquo;extension v3_OCSP, présente dans le fichier de configuration openssl-ca.cnf. Cette commande crée un fichier ocsp.csr dans le dossier miniCA\\csr, et génère une clé privée ocsp.pem, située dans le dossier miniCA\\private.\nPour la deuxième action, on génère le certificat, signé par la root CA. On utilise une seconde fois l\u0026rsquo;extension v3_OCSP. Le certificat généré est ocsp.pem, et est situé dans le dossier miniCA\\cert.\nLaunchOCSP Cette fonction permet de lancer le serveur OCSP, afin d\u0026rsquo;éviter de le lancer à la main. Il utilise le certificat miniCA\\cert\\ocsp.pem pour signer les réponses OCSP, ainsi que la clé privée miniCA\\private\\ocsp.pem, également pour signer les réponses OCSP.\nGestion des arguments Nous utilisons un Switch{.powershell} pour savoir quelle action est attendue du script mini-pki.ps1. Les actions possibles sont :\n  create-ca : appelle la fonction Create-CA{.powershell}\n  user-req : appelle la fonction User-req{.powershell}\n  user-sign : appelle la fonction User-sign{.powershell}\n  revoke : appelle la fonction Revoke{.powershell}\n  gencrl : appelle la fonction GenCRL{.powershell}\n  genocsp : appelle la fonction GenOCSP{.powershell}\n  ocsp : appelle la fonction LaunchOCSP{.powershell}.\n  Signatures ClamAV ClamAV utilise plusieurs formats de signature. Dans le cadre de cette documentation, nous en retiendrons deux :\n  les .yara [@yara-signatures] [@yara-hunting-signatures];\n  les .ndb[@ndb-signatures].\n  Description des formats de signature yara est un outil développé par VirusTotal qui permet notamment d\u0026rsquo;identifier ou de classifier des échantillons de malware. Ici, yara nous est utile dans la mesure où il permet de reconnaître une suite de caractères dans un document.\nndb est un format de signature basique utilisé par CalmAV pour la detection de virus dans les corps des objets.\nCe format permet de spécifier plus d\u0026rsquo;informations à rechercher lors de l\u0026rsquo;analyse des données.\nDescription des signatures yara utilise une syntaxe simple.\nNotre fichier src/epita.yara fonctionne comme suit :\n  Il déclare une variable contenant epita via le mot clé strings.\n  Il déclare ensuite la condition de détection via le mot clé condition.\n  rule epita { strings: $a = /epita/ condition: $a } ndb utilise aussi une syntaxe simple.\nIl se présente sous la forme :\nMalwareName:TargetType:Offset:HexSignature[:min_flevel:[max_flevel]] Avec :\n  MalwareName : nom du malware =\u0026gt; il existe une nomenclature mise en place par clamAV.\n  TargetType : valeur de 0 à 7\n  0 : tout type de fichier\n  1 : les exécutables Windows (format PE)\n  2 : les scripts\n  3 : HTML normalisé (voir archi.pdf)\n  4 : fichier mail\n  5 : graphiques\n  6 : les exécutables au format ELF\n  7 : fichier texte ASCII normalisé\n    Offset : valeur à laquelle débuter la recherche.\n  HexSignature : le mot clé que nous voulons chercher dans le document\n  [:min_flevel:[max_flevel]] : ce sont des options ; elles permettent d\u0026rsquo;indiquer un niveau de compression pour pouvoir, par exemple, détecter les virus avec un certain niveau de compression. Nous n\u0026rsquo;utiliserons pas ces options.\n  Dans notre cas la signature sera donc :\nHTML.EPITA:0:*:6570697461 "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/questions_r%C3%A9ponses/questions2/",
	"title": "Gestions des vulnérabilités avec OpenVAS",
	"tags": [],
	"description": "",
	"content": "Citez des produits de gestion de vulnérabilités ? Tout d\u0026rsquo;abord, il existe OpenVAS, qui est Open Source et est sous licence GNU GPL. Ensuite, il y a Nessus, le produit de gestion de vulnérabilités de Tenable Network. Enfin, il y a aussi Nexpose, l\u0026rsquo;outil de Rapid7.\nQu\u0026rsquo;est-ce qu\u0026rsquo;un scan authentifié ? Un scan authentifié va permettre d\u0026rsquo;identifier ce qui est installé sur une machine. Le scanner va en effet pouvoir se connecter à des postes de travail ou des serveurs, afin d\u0026rsquo;obtenir plus d\u0026rsquo;informations, comme notamment les services qui ne sont pas exposés.\nUn scan authentifié permet de scanner la machine avec des permissions élevées, contrairement à un scan dit \u0026quot;classique\u0026quot;.\nQu\u0026rsquo;est-ce qu\u0026rsquo;un scan de configuration ? C\u0026rsquo;est un type de scan qui permet de scanner les configurations d\u0026rsquo;un service.\nQuel est l\u0026rsquo;intérêt de gérer les actifs/assets dans ce type de solution ? Ce type de solution permet d\u0026rsquo;avoir un suivi des machines d\u0026rsquo;un réseau. Il peut facilement représenter le réseau sous forme de statistiques.\\\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/questions_r%C3%A9ponses/questions3/",
	"title": "Gestions des vulnérabilités avec un scanner de type host-based",
	"tags": [],
	"description": "",
	"content": "Quelle est la différence entre un scanner de type host-based et network-based ? Un scanner de type host-based examine les configurations du système, les systèmes de fichiers, les paramètres des registres, et toutes sortes d\u0026rsquo;autres informations qu\u0026rsquo;un hôte possède. Ces outils permettent d\u0026rsquo;apporter une vision \u0026quot;administrateur\u0026quot; de l\u0026rsquo;environnement et de son exposition.\nUn scanner de type network-based est conçu pour découvrir l\u0026rsquo;existence de vulnérabilités au sein d\u0026rsquo;un réseau. Ces outils permettent de donner un aperçu de l\u0026rsquo;environnement au niveau du réseau. Ce type de scanner adopte en général une vision \u0026quot;attaquant\u0026quot; de l\u0026rsquo;environnement.\nÉgalement, un scanner de type network-based est rapide et facilement déployable. Ils sont utiles pour détecter des périphériques escrocs sur le réseau, ou encore des services étranges en fonctionnement. Un scanner de type host-based est en général plus difficile à déployer qu\u0026rsquo;un scanner de type network-based, notamment car il requiert souvent l\u0026rsquo;installation d\u0026rsquo;un agent sur les systèmes. Aussi, ils vont permettre d\u0026rsquo;évaluer les dommages potentiels qui peuvent être causés autant par des personnes internes qu\u0026rsquo;externes, une fois qu\u0026rsquo;un certain niveau d\u0026rsquo;accès est accordé (légitimement ou non) sur un système.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi1/mise-en-place/",
	"title": "Mise en place de l&#39;architecture",
	"tags": [],
	"description": "",
	"content": "VirtualBox L\u0026rsquo;architecture du projet est construite via un outil de virtualisation. Nous utilisons VirtualBox.\nAdresse du fichier d\u0026rsquo;installation VirtualBox est disponible à cette adresse : https://www.virtualbox.org/wiki/Downloads\nDans la section \u0026quot;VirtualBox \u0026lt;version\u0026gt; plateform packages\u0026quot;, choisir son système d\u0026rsquo;exploitation.\nProcédure d\u0026rsquo;installation Merci de bien vouloir suivre la partie 1.6 de https://download.virtualbox.org/virtualbox/6.0.4/UserManual.pdf pour pouvoir installer l\u0026rsquo;outil.\nUtilisation Merci de bien vouloir lire la partie 1.7 de https://download.virtualbox.org/virtualbox/6.0.4/UserManual.pdf pour pouvoir utiliser VirtualBox.\nPfsense Adresse du fichier d\u0026rsquo;installation Pfsense est disponible à cette adresse : https://www.pfsense.org/download/\nComme le montre la figure 154{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;1\u0026rdquo;} :\n  Choisir votre architecture, AMD64 pour une architecture 64bits;\n  Choisir ISO;\n  Télécharger le contenu.\\\n  {#1}\n Procédure d\u0026rsquo;installation Afin d\u0026rsquo;obtenir une machine virtuelle opérationnelle, il faut suivre les étapes suivantes.\nCréer la nouvelle machine virtuelle :\n{#2}\nNommer la machine virtuelle pfSense, de type BSD et comme version, FreeBSD (64-bit). Cliquer sur Suivant :\n{#3}\nAttribuer la RAM qui sera allouée pour cette machine ; 1024 Mo suffisent. Cliquer sur Suivant :\n[[4]]{#4 label=\u0026ldquo;4\u0026rdquo;} Choisir de créer un disque dur virtuel maintenant. Cliquer sur Créer :\n[[5]]{#5 label=\u0026ldquo;5\u0026rdquo;} Choisir VDI comme type de disque dur. Cliquer sur Suivant :\n[[6]]{#6 label=\u0026ldquo;6\u0026rdquo;} Choisir l\u0026rsquo;option \u0026quot;Dynamiquement alloué\u0026quot;. Cliquer sur Suivant :\n[[7]]{#7 label=\u0026ldquo;7\u0026rdquo;} Choisir un emplacement de la machine virtuelle ; 8 Go suffisent. Cliquer sur Créer :\n[[8]]{#8 label=\u0026ldquo;8\u0026rdquo;} Ouvrir le menu de configuration :\n[[9]]{#9 label=\u0026ldquo;9\u0026rdquo;} Accéder à Stockage :\n[[10]]{#10 label=\u0026ldquo;10\u0026rdquo;} Dans stockage, choisir l\u0026rsquo;ISO pfSense téléchargé précédemment :\n[[11]]{#11 label=\u0026ldquo;11\u0026rdquo;} Configuration des interfaces réseaux de la machine virtuelle Pour pouvoir accéder au réseau interne et externe, il faut :\nAccéder au menu Réseau de la configuration, volet Interface 1, puis cocher Activer l’interface réseau. Il faut aussi mettre comme mode d\u0026rsquo;accès réseau : Accès par pont. Enfin, choisir le nom de sa carte réseau ayant un accès à internet :\n[[12]]{#12 label=\u0026ldquo;12\u0026rdquo;} Accéder au volet Interface 2, puis cocher Activer l’interface réseau. Il faut de plus choisir le mode d\u0026rsquo;accès réseau comme Réseau interne, dont le nom doit être \u0026quot;pfsense\u0026quot;. Enfin, cliquer sur OK :\n[[13]]{#13 label=\u0026ldquo;13\u0026rdquo;} Procédure d\u0026rsquo;installation Démarrer la machine virtuelle Pfsense. Attendre que la commande s\u0026rsquo;exécute seule ou appuyer sur la touche Entrée :\n{#Pfsense_Install/1}\nAttendre la fin de l\u0026rsquo;initialisation de Pfsense :\n{#Pfsense_Install/2}\nAppuyer sur la touche Entrée :\n{#Pfsense_Install/3}\nSélectionner l\u0026rsquo;option \u0026quot;Install pfSense\u0026quot;. Appuyer sur la touche Entrée :\n{#Pfsense_Install/4}\nSélectionner la configuration clavier en utilisant les flèches haut et bas. Une fois la configuration choisie, sélectionner Select avec les flèches, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/5}\nSélectionner \u0026quot;\u0026gt;\u0026gt;\u0026gt; Continue with ... keymap\u0026quot;, tout en haut de l\u0026rsquo;écran. Sélectionner Select avec les flèches et appuyer sur la touche Entrée :\n{#Pfsense_Install/6}\nSélectionner l\u0026rsquo;option \u0026quot;Auto (UFS) Guided Disk Setup\u0026quot;. Sélectionner OK avec les flèches, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/7}\nAttendre que l\u0026rsquo;installation se déroule :\n{#Pfsense_Install/8}\nSélectionner No avec les flèches, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/9}\nSélectionner Reboot avec les flèches, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/10}\nÉteindre la machine virtuelle quand celle-ci commence à se rallumer. Accéder au menu de Stockage du menu de configuration de la machine Pfsense (1). Suivre les étapes à l\u0026rsquo;aide des chiffres sur la figure 14{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Pfsense_Install/11\u0026rdquo;}. Sélectionner le disque Pfsense (2 et 3), et cliquer sur \u0026quot;Retirer le disque du lecteur virtuel\u0026quot; (4) :\n{#Pfsense_Install/11}\nRedémarrer la machine virtuelle Pfsense. Attendre que la commande s\u0026rsquo;exécute seule ou appuyer sur la touche Entrée :\n{#Pfsense_Install/12}\nTaper n à la question : \u0026quot;Should VLANs be set up now [y|n]?\u0026quot;, et appuyer sur la touche Entrée :\n{#Pfsense_Install/13}\nTaper le nom de l\u0026rsquo;interface WAN. Ici, em0, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/14}\nAppuyer sur la touche Entrée lors de la question sur la configuration de l\u0026rsquo;interface LAN :\n{#Pfsense_Install/15}\nTaper y pour confirmer la configuration réalisée, puis appuyer sur la touche Entrée :\n{#Pfsense_Install/16}\nArrêter la machine en tapant 6, puis y, et en appuyant sur la touche Entrée :\n{#Pfsense_Install/17}\nWindows Server 2012 Adresse du fichier d\u0026rsquo;installation L\u0026rsquo;ISO de Windows Server 2012 est disponible à l\u0026rsquo;url suivante : https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012?filetype=ISO\nProcédure d\u0026rsquo;installation de l\u0026rsquo;ISO dans la machine virtuelle Créer la nouvelle machine virtuelle :\n{#Windows_Server/1}\nNommer la machine virtuelle Windows Server 2012, de type Microsoft Windows et comme version, Other Windows (64-bit). Cliquer sur Suivant :\n{#Windows_Server/2}\nAttribuer la RAM qui sera allouée pour cette machine ; 2048 Mo suffisent. Cliquer sur Suivant :\n{#Windows_Server/3}\nChoisir de créer un disque dur virtuel maintenant. Cliquer sur Créer :\n{#Windows_Server/4}\nChoisir VDI comme type de disque dur. Cliquer sur Suivant :\n{#Windows_Server/5}\nChoisir l\u0026rsquo;option \u0026quot;Dynamiquement alloué\u0026quot;. Cliquer sur Suivant :\n{#Windows_Server/6}\nChoisir un emplacement de la machine virtuelle ; 20 Go suffisent. Cliquer sur Créer :\n{#Windows_Server/7}\nOuvrir le menu de configuration :\n{#Windows_Server/8}\nAccéder à Stockage. Choisir l\u0026rsquo;ISO WinServer 2012 téléchargée précédemment :\n{#Windows_Server/9}\nConfiguration de l\u0026rsquo;interface réseau de la machine virtuelle Pour pouvoir accéder au réseau interne, il faut :\nAccéder au menu Réseau de la configuration, volet Interface 1, et cocher Activer l’interface réseau. Il faut ensuite choisir le mode d\u0026rsquo;accès réseau : Réseau interne. Le nom doit être : pfsense. Enfin, cliquer sur OK :\n{#Windows_Server/10}\nInstallation de Windows 2012 Lancer la machine virtuelle Windows Server 2012. Renseigner les champs :\n{#WS2012_Screenshots/1}\nCliquer sur Installer maintenant :\n{#WS2012_Screenshots/2}\nSélectionner la deuxième option proposée : Windows Server 2012 Standard Evaluation (expérience de bureau). Cliquer sur Suivant :\n{#WS2012_Screenshots/3}\nLire \u0026quot;Avis et conditions du contrat de licence applicables\u0026quot;. Si vous êtes en accord avec ce texte, cocher la case \u0026quot;J\u0026rsquo;accepte les termes du contrat de licence\u0026quot;. Cliquer sur Suivant :\n{#WS2012_Screenshots/4}\nChoisir l\u0026rsquo;option : Personnalisé : installer uniquement Windows (avancé) :\n{#WS2012_Screenshots/5}\nChoisir le lecteur 0. Cliquer sur Suivant :\n{#WS2012_Screenshots/6}\nAttendre pendant l\u0026rsquo;installation de Windows :\n{#WS2012_Screenshots/7}\nCréer un nouveau mot de passe pour le compte Administrateur :\n{#WS2012_Screenshots/8}\nSe connecter avec le nouveau mot de passe :\n{#WS2012_Screenshots/9}\nCliquer sur Oui :\n{#WS2012_Screenshots/10}\nCliquer droit sur le logo des réseaux puis cliquer sur Ouvrir les paramètres réseau et Internet :\n{#WS2012_Screenshots/11}\nDans la section Ethernet, cliquer sur Centre Réseau et partage. Dans la nouvelle fenêtre, cliquer sur Modifier les paramètres de la carte :\n{#WS2012_Screenshots/12}\nCliquer droit sur la carte Ethernet. Cliquer sur Propriétés :\n{#WS2012_Screenshots/13}\nDécocher Protocole Internet version 6 (TCP/IPv6). Cliquer sur Protocole Internet version 4 (TCP/IPv4) puis sur Propriétés :\n{#WS2012_Screenshots/14}\nConfigurer les adresses IP comme suit :\n  Adresse IP : 192.168.2.2;\n  Masque de sous-réseau : 255.255.255.0;\n  Passerelle par défaut : 192.168.2.1.\n  Aussi, configurer l\u0026rsquo;adresse du serveur DNS préféré avec : 8.8.8.8. Cliquer sur OK :\n{#WS2012_Screenshots/15}\nCliquer sur Fermer :\n{#WS2012_Screenshots/16}\nWindows Adresse du fichier d\u0026rsquo;installation L\u0026rsquo;ISO de Windows 10 Entreprise est disponible à cette adresse : https://www.microsoft.com/fr-fr/evalcenter/evaluate-windows-10-enterprise1\nProcédure d\u0026rsquo;installation Créer la nouvelle machine virtuelle :\n{#W_Screenshots/1}\nNommer la machine virtuelle Windows 10, de type Microsoft Windows et comme version, Windows (64-bit). Cliquer sur Suivant :\n{#W_Screenshots/2}\nAttribuer la RAM qui sera allouée pour cette machine ; 2048 Mo suffisent. Cliquer sur Suivant :\n{#W_Screenshots/3}\nChoisir de créer un disque dur virtuel maintenant. Cliquer sur Suivant :\n{#W_Screenshots/4}\nChoisir VDI comme type de disque dur. Cliquer sur Suivant :\n{#W_Screenshots/5}\nChoisir l\u0026rsquo;option \u0026quot;Dynamiquement alloué\u0026quot;. Cliquer sur Suivant :\n{#W_Screenshots/6}\nChoisir un emplacement de la machine virtuelle arbitrairement ; 20 Go suffisent. Cliquer sur Créer :\n{#W_Screenshots/7}\nOuvrir le menu de configuration :\n{#W_Screenshots/8}\nAccéder à Stockage. Choisir l\u0026rsquo;ISO Windows 10 téléchargée précédemment :\n{#W_Screenshots/9}\nConfiguration de l\u0026rsquo;interface réseau de la machine virtuelle Pour pouvoir accéder au réseau interne, il faut:\nAccéder au menu Réseau de la configuration, volet Interface 1, et cocher Activer l’interface réseau. Il faut ensuite choisir le mode d\u0026rsquo;accès réseau : Réseau interne. Le nom doit être \u0026quot;pfsense\u0026quot;. Enfin, cliquer sur OK :\n{#W_Screenshots/10}\nInstallation de Windows Lancer la machine virtuelle Windows 10 :\n{#W_Screenshots/11}\nRenseigner les champs demandés, puis cliquer sur Suivant :\n{#W_Screenshots/12}\nCliquer sur Installer maintenant :\n{#W_Screenshots/13}\nCliquer sur \u0026quot;Je n\u0026rsquo;ai pas de clé de produit (Product Key)\u0026quot; :\n{#W_Screenshots/14}\nSélectionner l\u0026rsquo;option suivante : Windows 10 Professionnel pour les Stations de travail. Cliquer sur Suivant :\n{#W_Screenshots/15}\nLire \u0026quot;Avis et conditions du contrat de licence applicables\u0026quot;. Si vous êtes en accord avec ce texte, cocher la case \u0026quot;J\u0026rsquo;accepte les termes du contrat de licence\u0026quot;. Cliquer sur Suivant :\n{#W_Screenshots/16}\nChoisir l\u0026rsquo;option : Personnalisé : installer uniquement Windows (avancé) :\n{#W_Screenshots/17}\nChoisir le lecteur 0. Cliquer sur Suivant :\n{#W_Screenshots/18}\nAttendre pendant l\u0026rsquo;installation de Windows :\n{#W_Screenshots/19}\nÉcran de présentation de Windows 10 :\n{#W_Screenshots/20}\nChoisir la région de la machine, puis cliquer sur Oui :\n{#W_Screenshots/21}\nChoisir la disposition du clavier, puis cliquer sur Oui :\n{#W_Screenshots/22}\nPossibilité d\u0026rsquo;ignorer l\u0026rsquo;ajout d\u0026rsquo;une deuxième disposition de clavier en cliquant sur Ignorer :\n{#W_Screenshots/23}\nCliquer sur Ignorer pour le moment :\n{#W_Screenshots/24}\nDonner un nom d\u0026rsquo;utilisateur, puis cliquer sur Suivant :\n{#W_Screenshots/25}\nChoisir un mot de passe pour l\u0026rsquo;utilisateur, puis cliquer sur Suivant :\n{#W_Screenshots/26}\nConfirmer le mot de passe saisi précédemment. Cliquer sur Suivant :\n{#W_Screenshots/27}\nSélectionner la première question de sécurité de l\u0026rsquo;utilisateur et renseigner sa réponse. Cliquer sur Suivant :\n{#W_Screenshots/28}\nSélectionner la deuxième question de sécurité de l\u0026rsquo;utilisateur et renseigner sa réponse. Cliquer sur Suivant :\n{#W_Screenshots/29}\nSélectionner la troisième question de sécurité de l\u0026rsquo;utilisateur et renseigner sa réponse. Cliquer sur Suivant :\n{#W_Screenshots/30}\nCliquer sur Refuser pour désactiver l\u0026rsquo;utilisation de Cortana :\n{#W_Screenshots/31}\nCliquer sur Non pour ne pas activer l\u0026rsquo;historique des activités Windows 10 :\n{#W_Screenshots/32}\nSélectionner l\u0026rsquo;option \u0026quot;Ne pas utiliser la reconnaissance vocale en ligne\u0026quot;. Cliquer sur Accepter :\n{#W_Screenshots/33}\nSélectionner l\u0026rsquo;option \u0026quot;Non\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/34}\nSélectionner l\u0026rsquo;option \u0026quot;Non\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/35}\nSélectionner l\u0026rsquo;option \u0026quot;Basique\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/36}\nSélectionner l\u0026rsquo;option \u0026quot;Non\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/37}\nSélectionner l\u0026rsquo;option \u0026quot;Non\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/38}\nSélectionner l\u0026rsquo;option \u0026quot;Non\u0026quot;, puis cliquer sur Accepter :\n{#W_Screenshots/39}\nUtilisation Se connecter à la machine virtuelle Windows 10 nouvellement créée et installée, via le nom d\u0026rsquo;utilisateur renseigné lors de l\u0026rsquo;installation, et le mot de passe associé, tel que sur la figure suivante :\n{#W_Screenshots/40}\nLinux MINT Installation de Linux Mint Double-cliquer sur l\u0026rsquo;icône représentant un disque, nommé \u0026quot;Install Linux Mint\u0026quot; :\n{#Mint_Screenshots/1}\nSélectionner la langue pour l\u0026rsquo;installation, puis cliquer sur Continuer :\n{#Mint_Screenshots/2}\nChoisir la disposition du clavier, puis cliquer sur Continuer :\n{#Mint_Screenshots/3}\nCocher l\u0026rsquo;option pour installer les logiciels tiers, puis cliquer sur Continuer :\n{#Mint_Screenshots/4}\nSélectionner \u0026quot;Effacer le disque et installer Linux Mint\u0026quot;, puis cocher les deux options suivant ce choix. Cliquer sur Continuer :\n{#Mint_Screenshots/5}\nChoisir une clé de sécurité pour le chiffrement du disque, cocher \u0026quot;Ecraser l\u0026rsquo;espace disque vide\u0026quot;, puis cliquer sur Installer maintenant :\n{#Mint_Screenshots/6}\nConfirmer votre choix en cliquant sur Continuer :\n{#Mint_Screenshots/7}\nSélectionner le fuseau horaire vous correspondant, puis cliquer sur Continuer :\n{#Mint_Screenshots/8}\nCréer un nouvel utilisateur, tel que montré sur la figure ci-dessous. Cliquer sur Continuer :\n{#Mint_Screenshots/9}\nAttendre la fin de l\u0026rsquo;installation de Linux Mint :\n{#Mint_Screenshots/10}\nUne fois l\u0026rsquo;installation terminée, cliquer sur Redémarrer maintenant sur la nouvelle fenêtre :\n{#Mint_Screenshots/11}\nAttendre la fin de l\u0026rsquo;installation de Linux Mint :\n{#Mint_Screenshots/12}\nÉcran demandant la clé de déchiffrement du disque :\n{#Mint_Screenshots/13}\nÉcran de déchiffrement du disque :\n{#Mint_Screenshots/14}\nSe connecter en entrant les identifiants de l\u0026rsquo;utilisateur créé lors de l\u0026rsquo;installation :\n{#Mint_Screenshots/15}\nPage d\u0026rsquo;accueil à la première connexion sur Linux Mint :\n{#Mint_Screenshots/16}\nDebian Adresse du fichier d\u0026rsquo;installation L\u0026rsquo;ISO de Debian 9.9 est disponible à cette adresse : https://cdimage.debian.org/debian-cd/current/multi-arch/iso-cd/debian-9.9.0-amd64-i386-netinst.iso\nProcédure d\u0026rsquo;installation Nommer la machine virtuelle - ici nous avons opté pour \u0026quot;Debian DM4\u0026quot; - puis choisir le type Linux, avec pour version Debian (64-bits). Cliquer sur Suivant :\n{#Debian_screenshots/Install/1}\nAttribuer la RAM qui sera allouée pour cette machine ; 1024 Mo suffisent. Cliquer sur Suivant :\n{#Debian_screenshots/Install/2}\nChoisir de créer un disque dur virtuel maintenant. Cliquer sur Suivant :\n{#Debian_screenshots/Install/3}\nChoisir VDI comme type de disque dur. Cliquer sur Suivant :\n{#Debian_screenshots/Install/4}\nChoisir l\u0026rsquo;option \u0026quot;Dynamiquement alloué\u0026quot;. Cliquer sur Suivant :\n{#Debian_screenshots/Install/5}\nChoisir l\u0026rsquo;emplacement de la machine virtuelle, ainsi que la taille du disque dur virtuel ; 8 Go suffisent. Cliquer sur Créer :\n{#Debian_screenshots/Install/6}\nOuvrir le menu de configuration :\n{#Debian_screenshots/Install/7}\nAccéder à Stockage. Choisir l\u0026rsquo;ISO Debian téléchargée précédemment :\n{#Debian_screenshots/Install/8}\nInstallation de Debian Démarrer la machine virtuelle Debian :\n{#Debian_screenshots/Install/9}\nSélectionner l\u0026rsquo;option Graphical install en s\u0026rsquo;aidant des flèches. Appuyer sur la touche Entrée :\n{#Debian_screenshots/Install/10}\nSélectionner la langue utilisée pour l\u0026rsquo;installation de Debian. Cliquer sur la langue - \u0026quot;French\u0026quot; ici - puis cliquer sur Continue :\n{#Debian_screenshots/Install/11}\nChoisir la situation géographique. Les choix sont basés par rapport au choix précédent. Cliquer sur France, puis sur Continuer :\n{#Debian_screenshots/Install/12}\nConfigurer la disposition du clavier. Sélectionner Français, puis cliquer sur Continuer :\n{#Debian_screenshots/Install/13}\nAttendre la fin du chargement des composants d\u0026rsquo;installation :\n{#Debian_screenshots/Install/14}\nEnsuite, la fenêtre pour la configuration réseau s\u0026rsquo;ouvre. La première étape est d\u0026rsquo;indiquer le nom du système en installation. Ici, \u0026quot;INFRA01\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/15}\nLaisser le champ du domaine vide, et cliquer sur Continuer :\n{#Debian_screenshots/Install/16}\nLa fenêtre suivante consiste en la création du mot de passe du superutilisateur \u0026lsquo;root\u0026rsquo;. Le mot de passe doit respecter les bonnes pratiques de l\u0026rsquo;ANSSI. Une fois le mot de passe choisi, cliquer sur Continuer :\n{#Debian_screenshots/Install/17}\nDonner le nom complet de l\u0026rsquo;utilisateur en création. Dans la figure ci-dessous, nous avons entré \u0026quot;User01\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/18}\nDonner un identifiant pour le compte utilisateur. Dans la figure suivante, nous avons entré \u0026quot;user01\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/19}\nComme pour le superutilisateur, définir un mot de passe pour l\u0026rsquo;utilisateur \u0026quot;user01\u0026quot; en création. Ce mot de passe doit respecter les bonnes pratiques de l\u0026rsquo;ANSSI. Cliquer sur Continuer :\n{#Debian_screenshots/Install/20}\nAttendre la fin du chargement de configuration de l\u0026rsquo;horloge :\n{#Debian_screenshots/Install/21}\nLa fenêtre suivante s\u0026rsquo;occupe du partitionnement des disques. Sélectionner la première option : Assisté - utiliser un disque entier, puis cliquer sur Continuer :\n{#Debian_screenshots/Install/22}\nSélectionner le disque à partitionner, puis cliquer sur Continuer :\n{#Debian_screenshots/Install/23}\nEnsuite, sélectionner le schéma de partitionnement \u0026quot;Tout dans une seule partition (recommandé pour les débutants)\u0026quot;, puis cliquer sur Continuer :\n{#Debian_screenshots/Install/24}\nVérifier que la configuration ressemble à celle de la figure suivante, puis sélectionner \u0026quot;Terminer le partitionnement et appliquer les changements\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/25}\nChoisir Oui puis cliquer sur Continuer :\n{#Debian_screenshots/Install/26}\nPatienter pendant l\u0026rsquo;installation du système :\n{#Debian_screenshots/Install/27}\nEnsuite, choisir Non dans la fenêtre de configuration de l\u0026rsquo;outil de gestion des paquets, puis cliquer sur Continuer :\n{#Debian_screenshots/Install/28}\nSélectionner le pays du miroir de l\u0026rsquo;archive Debian le plus proche. Ici, sélectionner \u0026quot;France\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/29}\nSélectionner le miroir de l\u0026rsquo;archive Debian. Ici ftp.fr.debian.org. Cliquer sur Continuer :\n{#Debian_screenshots/Install/30}\nLaisser le champ sur le mandataire HTTP vide, et cliquer sur Continuer :\n{#Debian_screenshots/Install/31}\nAttendre la fin de la configuration de l\u0026rsquo;outil de gestion des paquets :\n{#Debian_screenshots/Install/32}\nSélectionner Non pour la configuration de popularity-contest, et cliquer sur Continuer :\n{#Debian_screenshots/Install/33}\nAttendre la fin de l\u0026rsquo;installation des logiciels :\n{#Debian_screenshots/Install/34}\nEnsuite, sélectionner les options comme sur la figure suivante : \u0026quot;environnement de bureau Debian\u0026quot;, \u0026quot;serveur d\u0026rsquo;impression\u0026quot; et \u0026quot;utilitaires usuels du système\u0026quot;, ainsi que \u0026quot;serveur SSH\u0026quot;. Cliquer sur Continuer :\n{#Debian_screenshots/Install/35}\nPatienter jusqu\u0026rsquo;à la fin de la configuration et de l\u0026rsquo;installation des logiciels :\n{#Debian_screenshots/Install/36}\nSélectionner Oui pour installer le programme de démarrage GRUB sur le secteur d\u0026rsquo;amorçage. Cliquer sur Continuer :\n{#Debian_screenshots/Install/37}\nSélectionner le périphérique où sera installé le programme de démarrage GRUB, tel que montré sur la figure ci-dessous. Cliquer sur Continuer :\n{#Debian_screenshots/Install/38}\nAttendre la fin de l\u0026rsquo;installation du programme de démarrage GRUB sur le disque dur :\n{#Debian_screenshots/Install/39}\nCliquer sur Continuer afin de terminer l\u0026rsquo;installation :\n{#Debian_screenshots/Install/40}\nAttendre que la machine redémarre :\n{#Debian_screenshots/Install/41}\nUne fois la machine redémarrée, il est possible de se connecter en tant que User01, comme montré sur la figure suivante :\n{#Debian_screenshots/Install/42}\nMISP Adresse du fichier d\u0026rsquo;installation Une machine virtuelle MISP est mise à disposition à l\u0026rsquo;adresse : https://www.circl.lu/misp-images/latest/ Pour VirtualBox, il faut télécharger le fichier OVA.\nAvant de procéder à l\u0026rsquo;importation de la machine virtuelle, il faut vérifier l\u0026rsquo;intégrité du fichier téléchargé. La signature de ce fichier est également disponible, dans le fichier ayant pour extension : \u0026quot;.ova.asc\u0026quot;. La méthode pour vérifier les signatures se trouve dans le fichier verify.txt, mis à disposition. Sur la figure suivante sont mis en exergue les trois fichiers concernés :\n{#1}\nProcédure d\u0026rsquo;installation Dans VirtualBox, il faut commencer par Importer un appareil virtuel, en cliquant sur \u0026quot;Fichier\u0026quot; puis sur Importer un appareil virtuel..., tel que sur la figure suivante :\n{#1}\nIl faut ensuite choisir le fichier OVA concerné ; celui téléchargé précédemment, puis cliquer sur Suivant \u0026gt; :\n{#1}\nLes caractéristiques de la machine virtuelle sont listées. Il est possible de modifier chacun des champs, en double-cliquant dessus, puis modifier le champ sélectionné. Ici, nous avons changé le nom de la machine virtuelle à \u0026quot;SECU01\u0026quot;. Il est également possible de choisir où seront sauvegardés les fichiers de la machine virtuelle. Cliquer sur Importer :\n{#1}\nCliquer sur Accepter :\\\n{#1}\nAttendre pendant l\u0026rsquo;importation de l\u0026rsquo;appareil virtuel :\n{#1}\nDémarrer la machine virtuelle \u0026quot;SECU01\u0026quot; nouvellement importée. Les identifiants par défaut de la machine virtuelle sont :\n  MISP Login : misp\n  Mot de passe : Password1234\n  {#1}\nGraylog Graylog est la solution de gestion de logs centralisée, afin de donner une autre signification plus visuelle que de simples lignes de texte.\nAdresse d\u0026rsquo;installation L\u0026rsquo;installation de la machine virtuelle est simple : il suffit de se rendre sur le lien suivant.\nhttps://packages.graylog2.org/releases/graylog-omnibus/ova/graylog-2.5.1-1.ova.\nCe fichier est une sauvegarde de machine virtuelle prête à l\u0026rsquo;emploi qu\u0026rsquo;il suffit d\u0026rsquo;importer avec VirtualBox.\nProcédure d\u0026rsquo;installation De la même manière que pour MISP, il faut commencer par Importer un appareil virtuel, en cliquant sur \u0026quot;Fichier\u0026quot; puis sur Importer un appareil virtuel....\nIl faut ensuite choisir le fichier OVA concerné ; celui téléchargé précédemment, puis cliquer sur Suivant \u0026gt; :\n{#1}\nOn peut encore modifier chacun des champs, en double-cliquant dessus, puis modifier le champ sélectionné. Ici, nous avons aussi changé le nom de la machine virtuelle à \u0026quot;SECU02\u0026quot;. Cliquer sur Importer :\n{#1}\nAttendre pendant l\u0026rsquo;importation de l\u0026rsquo;appareil virtuel :\n{#1}\nDémarrer la machine virtuelle \u0026quot;SECU02\u0026quot; nouvellement importée. Les identifiants par défaut de la machine virtuelle sont :\n  Login : ubuntu\n  Mot de passe : ubuntu\n  "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi2/mise-en-place/",
	"title": "Mise en place de l&#39;architecture",
	"tags": [],
	"description": "",
	"content": "Kali Adresse du fichier d\u0026rsquo;installation Une machine virtuelle Kali est mise à disposition à l\u0026rsquo;adresse\nPour VirtualBox, il faut télécharger le fichier OVA. Avant de procéder à l\u0026rsquo;importation de la machine virtuelle, il faut vérifier l\u0026rsquo;intégrité du fichier téléchargé. La signature de ce fichier est également disponible, à côté du lien de téléchargement du fichier OVA.\nSur la figure ci-après sont mis en exergue le fichier à télécharger ainsi que sa signature. Sélectionner l\u0026rsquo;onglet KALI LINUX VIRTUALBOX IMAGES pour récupérer l\u0026rsquo;image VirtualBox de Kali Linux. Ensuite, cliquer sur la version de Kali voulue - ici la version 64-bit. La signature de cette image est également disponible afin de vérifier l\u0026rsquo;intégrité de l\u0026rsquo;image :\n{#Kali_Screenshots/Installation/1}\nProcédure d\u0026rsquo;installation Dans VirtualBox, cliquer sur l\u0026rsquo;onglet Fichier, puis cliquer sur Importer un appareil virtuel..., tel que montré sur la figure suivante :\n{#Kali_Screenshots/Installation/2}\nSélectionner le fichier OVA à importer, puis cliquer sur Suivant \u0026gt; :\n{#Kali_Screenshots/Installation/3}\nSélectionner les paramètres voulus pour la machine virtuelle Kali Linux qui est importée. Ici, il a été choisi de générer de nouvelles adresses MAC pour toutes les interfaces réseau, par exemple. Une fois cela fait, cliquer sur Importer :\n{#Kali_Screenshots/Installation/4}\nAccepter les termes du contrat de licence logiciel affichés, en cliquant sur Accepter :\n{#Kali_Screenshots/Installation/5}\nPatienter pendant l\u0026rsquo;importation de l\u0026rsquo;appareil virtuel Kali Linux dans VirtualBox :\n{#Kali_Screenshots/Installation/6}\nWindows 8 Une machine Windows 8 est installée et intégrée au domaine dans le cadre de l\u0026rsquo;utilisation de l\u0026rsquo;outil MBSA, qui n\u0026rsquo;est pas compatible avec Windows 10.\nAdresse du fichier d\u0026rsquo;installation L\u0026rsquo;ISO de Windows 8 n\u0026rsquo;est plus mise à disposition sur le site de Microsoft. Il est tout de même possible d\u0026rsquo;en trouver une en version d\u0026rsquo;évaluation au lien suivant : https://www.clubic.com/telecharger-fiche410822-windows-8-release-preview.html\nProcédure d\u0026rsquo;installation de l\u0026rsquo;ISO dans la machine virtuelle Créer la nouvelle machine virtuelle :\n{#Windows8_screenshots/Install/1}\nNommer la machine virtuelle Windows 8.1, de type Microsoft Windows et comme version, Windows 8.1 (64-bit). Cliquer sur Suivant :\n{#Windows8_screenshots/Install/2}\nAttribuer la RAM qui sera allouée pour cette machine ; 2048 Mo suffisent. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/3}\nChoisir de créer un disque dur virtuel maintenant. Cliquer sur Créer :\n{#Windows8_screenshots/Install/4}\nChoisir VDI comme type de disque dur. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/5}\nChoisir l\u0026rsquo;option \u0026quot;Dynamiquement alloué\u0026quot;. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/6}\nChoisir un emplacement de la machine virtuelle ; 20 Go suffisent. Cliquer sur Créer :\n{#Windows8_screenshots/Install/7}\nCliquer droit sur la machine virtuelle Windows 8.1, puis sur Configuration... afin d\u0026rsquo;ouvrir le menu de configuration :\n{#Windows8_screenshots/Install/8}\nAccéder à Stockage. Choisir l\u0026rsquo;ISO de Windows 8.1 téléchargée précédemment :\n{#Windows8_screenshots/Install/9}\nConfiguration de l\u0026rsquo;interface réseau de la machine Pour pouvoir accéder au réseau interne, il faut :\nAccéder au menu Réseau de la configuration, volet Interface 1, et cocher Activer l’interface réseau. Il faut ensuite choisir le mode d\u0026rsquo;accès réseau : Réseau interne. Le nom doit être : pfsense. Enfin, cliquer sur OK :\n{#Windows8_screenshots/Install/10}\nInstallation de Windows 8.1 Lancer la machine virtuelle Windows 8.1. Renseigner les champs :\n{#Windows8_screenshots/Install/11}\nCliquer sur Installer maintenant :\n{#Windows8_screenshots/Install/12}\nLire \u0026quot;Avis et conditions du contrat de licence applicables\u0026quot;. Si vous êtes en accord avec ce texte, cocher la case \u0026quot;J\u0026rsquo;accepte les termes du contrat de licene\u0026quot;. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/13}\nChoisir l\u0026rsquo;option : Personnalisé : installer uniquement Windows (avancé) :\n{#Windows8_screenshots/Install/14}\nChoisir le lecteur 0. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/15}\nAttendre pendant l\u0026rsquo;installation de Windows :\n{#Windows8_screenshots/Install/16}\nSélectionner une couleur pour le thème du PC, et choisir le nom du PC. Ici, PC02. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/17}\nCliquer sur Personnaliser :\n{#Windows8_screenshots/Install/18}\nCliquer sur Oui :\n{#Windows8_screenshots/Install/19}\nChoisir les paramètres concernant les mises à jour, ainsi que ceux concernant la protection du PC et de la vie privée de l\u0026rsquo;utilisateur. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/20}\nChoisir les paramètres concernant la recherche de solutions en ligne ainsi que la participation à l\u0026rsquo;amélioration des produits et services Microsoft. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/21}\nChoisir les paramètres concernant le partage des informations avec Microsoft et d\u0026rsquo;autres services. Cliquer sur Suivant :\n{#Windows8_screenshots/Install/22}\nCliquer sur Créer un nouveau compte :\n{#Windows8_screenshots/Install/23}\nCliquer sur Se connecter sans compte Microsoft :\n{#Windows8_screenshots/Install/24}\nChoisir un nom d\u0026rsquo;utilisateur, ainsi qu\u0026rsquo;un mot de passe et une indication de mot de passe, puis cliquer sur Terminer :\n{#Windows8_screenshots/Install/25}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/cartographie/scan_actif/",
	"title": "Scan actif",
	"tags": [],
	"description": "",
	"content": "Découverte des machines présentes sur le réseau Afin de pouvoir identifier les machines d\u0026rsquo;un réseau, il est possible de lancer un scan de découverte avec NMAP.\nPlusieurs scans de découverte sont possibles. Cependant, certaines configurations de logiciels de sécurité permettent de bloquer la découverte du réseau.\nLes commandes suivantes permettent un scan de découverte sur l\u0026rsquo;ensemble des adresses IPv4 privées :\nnmap -PU -sn -n 192.168.0.0/16 nmap -PU -sn -n 10.0.0.0/8 nmap -PU -sn -n 172.16.0.0/12 Ces commandes utilisent UDP pour pouvoir détecter la présence de machines sur le réseau.\nL\u0026rsquo;utilisation d\u0026rsquo;UDP étant peu courante, il est probable que les équipements de sécurité ne soient pas configurés pour la détection de ce type de scan.\nLes options sont :\n  -PU : permet d\u0026rsquo;ouvrir et de fermer les sondes TCP proprement et donc de maîtriser le nombre de connexions utilisées sur la machine scannée ;\n  -n : évite de faire une requête DNS, permet de réduire l\u0026rsquo;empreinte réseau du scan ;\n  -sn : empêche le scan de ports.\n  Résultat du scan de découverte du réseau Le scan des adresses IP 192.168.0.0/16 via la commande énoncée plus haut a permis d\u0026rsquo;obtenir :\n{#discovery/1}\nAinsi, nous avons pu identifier sur 192.168.0.0/16, 6 machines :\n  192.168.2.1, adresse MAC : 08:00:27:CD:BF:EE ;\n  192.168.2.2, adresse MAC : 08:00:27:29:C9:C2 ;\n  192.168.2.3, adresse MAC : 08:00:27:96:D4:C3 ;\n  192.168.2.11, adresse MAC : 08:00:27:8F:E3:1D ;\n  192.168.2.21, Kali Linux ;\n  192.168.3.2, adresse MAC : inconnue car pas dans le même sous-réseau.\n  Pour pouvoir scanner avec des adresses IPv6 il suffit d\u0026rsquo;utiliser la commande NMAP :\nnmap -6 -n -sn fd00::/8 Les options sont :\n  -6 : permet d\u0026rsquo;indiquer l\u0026rsquo;utilisation de IPv6 ;\n  -n : évite de faire une requête DNS, permet de réduire l\u0026rsquo;empreinte réseau du scan ;\n  -sn : empêche le scan de ports.\n  Résultat du scan de découverte des systèmes d\u0026rsquo;exploitation Il est possible de faire un deuxième scan sur les machines découvertes pour identifier leur système d\u0026rsquo;exploitation. La commande NMAP utilisée est :\nnmap -O -n -Pn --osscan-guess 192.168.x.x Les options sont :\n  -O : permet d\u0026rsquo;activer la détection de système d\u0026rsquo;exploitation ;\n  -n : évite de faire une requête DNS, permet de réduire l\u0026rsquo;empreinte réseau du scan ;\n  -Pn : considère que la machine cible est en ligne ;\n  \u0026ndash;osscan-guess : permet d\u0026rsquo;indiquer les systèmes d\u0026rsquo;exploitation proches du résultat de la détection.\n  Résultat du scan de découverte pour 192.168.2.1 {#discovery/1}\nRésultat du scan de découverte pour 192.168.2.2 {#discovery/1}\nRésultat du scan de découverte pour 192.168.2.3 {#discovery/1}\nRésultat du scan de découverte pour 192.168.2.11 {#discovery/1}\nRésultat du scan de découverte pour 192.168.3.2 La figure ci-après nous indique une distance de 2 hops pour joindre la machine 192.168.3.2 :\n{#discovery/1}\nEmpreintes réseau des scans de découverte Pour chaque machine, 1050 paquets réseaux ont du être envoyés à la machine cible pour réaliser le scan.\nLe PCAP de la capture réseau est disponible dans l\u0026rsquo;archive de la documentation.\nRecherche des systèmes SCADA Les infrastructures critiques ont besoin d\u0026rsquo;être scannés avec précaution. Afin de déterminer si des systèmes ICS/SCADA sont présents, nous lançons la commande NMAP suivante :\nnmap -sT \\  -p 80,102,443,502,530,593,789,1089-1091,1911,1962,2222,2404, \\  4000,4840,4843,4911,9600,34964,34980,44818,46823,46824,55000-55003 \\  -T1 -v -n --max-parallelism 1 -Pn --packet-trace 192.168.x.x Les options sont :\n  -sT : permet d\u0026rsquo;ouvrir et de fermer les sondes TCP proprement et donc de maîtriser le nombre de connexions utilisées sur la machine scannée ;\n  -p ports : les ports spécifiés dans la commande NMAP sont les ports utilisés le plus fréquemment par les systèmes ICS/SCADA, une réponse positive de l\u0026rsquo;un de ces ports peut indiquer la présence d\u0026rsquo;un ICS/SCADA (hormis les ports 80/443) ;\n  -T1 : le -T est une option permettant de gérer le timing des scans de port. Mettre cette option à 1 permet de s\u0026rsquo;assurer que le scan n\u0026rsquo;est pas détecté par les IDS et ne surcharge pas les machines scannées ;\n  -v : permet d\u0026rsquo;avoir le premier niveau d\u0026rsquo;information sur le scan en cours ;\n  -n : évite de faire une requête DNS, permet de réduire l\u0026rsquo;empreinte réseau du scan ;\n  \u0026ndash;max-parallelism 1 : garantit qu\u0026rsquo;une seule probe est utilisée à la fois ;\n  -Pn : empêche le système de ping la machine scannée pour vérifier son état, nous considérons que la machine est en ligne. Nous avons cette information grâce aux scans précédents ;\n  \u0026ndash;packet-trace : permet de suivre l\u0026rsquo;envoi et la réception des paquets. Cette option donne plus d\u0026rsquo;informations sur comment NMAP gère les paquets.\n  Les ports utilisés correspondent aux tableaux ci-dessous :\n{#MBSA_screenshots/Install-Win8/8}\nScan de la machine 192.168.2.1 {#MBSA_screenshots/Install-Win8/8}\nScan de la machine 192.168.2.2 {#MBSA_screenshots/Install-Win8/8}\nScan de la machine 192.168.2.3 {#MBSA_screenshots/Install-Win8/8}\nScan de la machine 192.168.2.11 {#MBSA_screenshots/Install-Win8/8}\nEmpreintes réseau des scans SCADA/ICS Pour chaque machine, 224 paquets réseaux ont du être envoyés à la machine cible pour réaliser le scan.\nLe PCAP de la capture réseau correspondant à un scan réseau SCADA/ICS est disponible dans l\u0026rsquo;archive de la documentation.\nScan agressif sur les machines du parc Pour pouvoir identifier les services associés aux ports d\u0026rsquo;une machine et détecter certaines vulnérabilités, nous pouvons utiliser une version agressive de NMAP. Cette variante de NMAP peut faire dysfonctionner les machines cibles.\nDe plus, lors de l\u0026rsquo;exécution de la commande, l\u0026rsquo;attaquant s\u0026rsquo;expose fortement à la détection des pare-feux et autres composants de sécurité du réseau ciblé.\nLa commande ci-dessous permet de lancer un scan agressif sur les machines dont l\u0026rsquo;adresse IP est associée :\nnmap -A \\  -n -Pn \\  --script http-brute,http-cookie-flags,http-cors,http-csrf, \\  http-date,http-enum,http-errors,http-favicon, \\  ssh-brute,sshv1,ssl-heartbleed,ssl-poodle 192.168.x.x Les options sont :\n  -A : cette option permet d\u0026rsquo;activer la détection agressive de NMAP. En mode agressif, NMAP active la détection de système d\u0026rsquo;exploitation (-o), la détection de version (-sV), le scan de scripts (-sC) et le traçage du chemin (\u0026ndash;traceroute);\n  -n : évite de faire une requête DNS, permet de réduire l\u0026rsquo;empreinte réseau du scan ;\n  -Pn : empêche le système de ping la machine scannée pour vérifier son état, nous considérons que la machine est en ligne. Nous avons cette information grâce aux scans précédents ;\n  -script scripts : cette option permet d\u0026rsquo;utiliser des scripts NSE lors du scan ;\n  Les scripts utilisés sont :\n  http-brute : permet de brute-force les secrets d\u0026rsquo;une authentification http basique, d\u0026rsquo;un digest ou d\u0026rsquo;une authentification NTLM ;\n  http-cookie-flag : permet d\u0026rsquo;examiner les cookies des services HTTP. Rapporte toutes les mauvaises configurations des cookies ;\n  http-cors : permet d\u0026rsquo;identifier des serveurs HTTP vulnérables à une Cross-Origin Resource Sharing (CORS) ;\n  http-csrf : permet de détecter les serveurs HTTP vulnérables à des Cross Site Request Forgeries (CSRF) ;\n  http-enum : permet d\u0026rsquo;énumérer les dossiers d\u0026rsquo;un serveur HTTP à partir des plus connus ;\n  http-errors : permet de retourner toutes les pages d\u0026rsquo;erreurs trouvées sur le site ;\n  http-favicon : permet de comparer la favicon du serveur HTTP avec une base de données de favicon pour pouvoir identifier le service ;\n  ssh-brute : tente d\u0026rsquo;établir une connexion SSH avec un brute-force des secrets d\u0026rsquo;authentification ;\n  sshv1 : permet d\u0026rsquo;identifier si le serveur cible permet une communication avec le protocole sshv1 ;\n  ssl-heartbleed : permet d\u0026rsquo;identifier si le serveur est vulnérable à heartbleed ;\n  ssl-poodle : permet d\u0026rsquo;identifier si le serveur est vulnérable à poodle.\n  Scan agressif de la machine 192.168.2.1 La figure ci-dessous est le résultat du scan sur 192.168.2.1 :\n{#MBSA_screenshots/Install-Win8/8}\nScan agressif de la machine 192.168.2.2 Les figures ci-dessous sont le résultat du scan sur 192.168.2.2.\nLe scan permet de nous révéler un Windows Server 2012 R2, vulnérable à poodle :\n{#MBSA_screenshots/Install-Win8/8}\n{#MBSA_screenshots/Install-Win8/8}\nScan agressif de la machine 192.168.2.3 Les figures ci-dessous sont le résultat du scan sur 192.168.2.3.\nLe scan nous permet d\u0026rsquo;identifier un serveur Linux avec comme information d\u0026rsquo;hôte : misp.circl.lu.\nLa machine est une MISP. Les services tels que SMTP ou encore ZMTP sont caractéristiques d\u0026rsquo;une virtual appliance MISP.\n{#MBSA_screenshots/Install-Win8/8}\n{#MBSA_screenshots/Install-Win8/8}\n{#MBSA_screenshots/Install-Win8/8}\nScan agressif de la machine 192.168.2.11 La figure ci-dessous est le résultat du scan sur 192.168.2.11.\nLe scan permet d\u0026rsquo;identifier un service de Windows. Il s\u0026rsquo;agit d\u0026rsquo;une machine d\u0026rsquo;un AD :\n{#MBSA_screenshots/Install-Win8/8}\nScan agressif de la machine 192.168.3.2 La figure ci-dessous permet d\u0026rsquo;identifier un serveur http nginx :\n{#MBSA_screenshots/Install-Win8/8}\nEmpreintes réseau des scans agressifs Le scan agressif a généré plus de 24500 paquets réseau par machine scannée.\nLe PCAP associé au scan est disponible dans l\u0026rsquo;archive de la documentation.\nAnnexe 1 {#Annexe/2}\nAnnexe 2 {#Annexe/2}\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/analyse/",
	"title": "Analyse",
	"tags": [],
	"description": "",
	"content": "Archi  Ce document va détailler pas à pas les instructions à effectuer afin de reproduire l\u0026rsquo;architecture Active Directory de notre groupe. Sur chaque diapositive sera écrit la machine sur laquelle effectuer les opérations décrites. Il sera donc de la responsabilité de la personne effectuant les opérations d\u0026rsquo;une diapositive de sélectionner la machine annoncée.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi1/configuration/",
	"title": "Configuration de l&#39;architecture",
	"tags": [],
	"description": "",
	"content": "Pfsense Démarrer la machine virtuelle Pfsense, comme sur la figure suivante :\n{#Pfsense_Screeshots/14}\nConfiguration des adresses IP Sélectionner l\u0026rsquo;option de configuration des interfaces IP, en tapant 2, puis appuyer sur la touche Entrée :\n{#Pfsense_Screeshots/15}\nTaper 1, puis y, et n. Appuyer sur Entrée, puis ré-entrer n. Appuyer une dernière fois sur Entrée :\n{#Pfsense_Screeshots/16}\nSélectionner l\u0026rsquo;option de configuration des interfaces IP, en tapant 2, puis appuyer sur la touche Entrée :\n{#Pfsense_Screeshots/15}\nTaper 2. Entrer l\u0026rsquo;adresse IP : 192.168.2.1. Taper 24, puis appuyer deux fois sur la touche Entrée. Taper n aux deux dernières questions :\n{#Pfsense_Screeshots/17}\nVérifier le bon paramétrage de Pfsense avec la figure suivante :\n{#Pfsense_Screeshots/18}\nConfiguration des règles Pfsense Démarrer la machine virtuelle Windows Server 2012. Se connecter sur la machine Windows Server 2012 avec le compte administrateur et le mot de passe définit à l\u0026rsquo;installation :\n{#Pfsense_Screeshots/19}\nOuvrir Internet Explorer, et aller à l\u0026rsquo;adresse : 192.168.2.1. Se connecter avec les identifiants Pfsense par défaut. Changer le mot de passe de Pfsense :\n{#Pfsense_Screeshots/20}\nAccéder à la page Rules, située dans Firewall :\n{#Pfsense_Screeshots/21}\nAller dans la section LAN. Les étapes de modification des règles Pfsense sont les suivantes :\n  Désactiver les deux règles existantes;\n  Créer une règle filtrant les trames IPv4 TCP/UDP provenant de 192.168.2.2, sur le port 53 (DNS);\n  Créer une règle filtrant les trames IPv4 TCP/UDP provenant de 192.168.2.0/24, sur le port 443 (HTTPS);\n  Créer une règle filtrant les trames IPv4 TCP/UDP provenant de 192.168.2.0/24, sur le port 80 (HTTP).\n  Le résultat attendu est affiché sur la figure suivante :\n{#Pfsense_Screeshots/22}\nWindows Server 2012 Ajout de fonctionnalités de Windows Server Démarrer la machine virtuelle Windows Server 2012. Ouvrir le gestionnaire de serveur (s\u0026rsquo;ouvre normalement automatiquement lors du démarrage de la machine). Cliquer sur \u0026quot;Ajouter des rôles et des fonctionnalités\u0026quot; :\n{#WS2012_Screenshots/17}\nAller dans la section Avant de commencer, puis cliquer sur Suivant :\n{#WS2012_Screenshots/18}\nAller dans la section Type d\u0026rsquo;installation, sélectionner la première option \u0026quot;Installation basée sur un rôle ou une fonctionnalité\u0026quot;, puis cliquer sur Suivant :\n{#WS2012_Screenshots/19}\nAller dans la section Sélection du serveur. Cocher l\u0026rsquo;option \u0026quot;Sélectionner un serveur de pool de serveurs\u0026quot;. Choisir DC01.EPITAF.local, puis cliquer sur Suivant :\n{#WS2012_Screenshots/20}\nAller dans la section Rôles de serveurs. Cocher les options :\n  Serveur DHCP (installé);\n  Serveur DNS (installé);\n  Services AD DS (Installé).\n  Cliquer sur Suivant, puis cliquer sur Ajouter des fonctionnalités :\n{#WS2012_Screenshots/21}\nCliquer sur Ajouter des fonctionnalités :\n{#WS2012_Screenshots/22}\nCliquer sur Ajouter des fonctionnalités :\n{#WS2012_Screenshots/23}\nCliquer sur Ajouter des fonctionnalités :\n{#WS2012_Screenshots/24}\nCliquer sur Suivant :\n{#WS2012_Screenshots/25}\nAller dans la section Fonctionnalités. Cocher l\u0026rsquo;option de chiffrement de lecteur BitLocker. Cliquer sur Ajouter des fonctionnalités :\n{#WS2012_Screenshots/26}\nAller dans la section Serveur DHCP. Cliquer sur Suivant :\n{#WS2012_Screenshots/27}\nAller dans la section Serveur DNS. Cliquer sur Suivant :\n{#WS2012_Screenshots/28}\nAller dans la section Serveur AD DS. Cliquer sur Suivant :\n{#WS2012_Screenshots/29}\nAller dans la section Serveur AD LDS. Cliquer sur Suivant :\n{#WS2012_Screenshots/30}\nAller dans la section Confirmation. Cliquer sur Installer :\n{#WS2012_Screenshots/31}\nAller dans la section Résultats, et attendre la fin de l\u0026rsquo;installation :\n{#WS2012_Screenshots/32}\nFin de l\u0026rsquo;installation. Cliquer sur Fermer :\n{#WS2012_Screenshots/33}\nConfiguration du DNS Cliquer sur Outils, puis cliquer sur DNS :\n{#WS2012_Screenshots/34}\nCliquer droit sur Redirecteurs, puis cliquer sur Propriétés :\n{#WS2012_Screenshots/35}\nEntrer la valeur \u0026quot;8.8.8.8\u0026quot; dans le nouveau champ :\n{#WS2012_Screenshots/36}\nCliquer sur OK :\n{#WS2012_Screenshots/37}\nCocher l\u0026rsquo;option \u0026quot;Ce serveur assure la maintenance de la zone\u0026quot;, puis cliquer sur Suivant :\n{#WS2012_Screenshots/38}\nCliquer sur Appliquer :\n{#WS2012_Screenshots/39}\nGestion du DHCP Cliquer sur Outils, puis cliquer sur DHCP :\n{#WS2012_Screenshots/40}\nCliquer droit sur IPv4, puis cliquer sur Propriétés :\n{#WS2012_Screenshots/41}\nCliquer sur Suivant :\n{#WS2012_Screenshots/42}\nEntrer la valeur \u0026quot;Etendu EPITAF\u0026quot; dans le champ Nom, et \u0026quot;192.168.2.10-192.168.2.20\u0026quot; dans le champ Description. Cliquer sur Suivant :\n{#WS2012_Screenshots/43}\nEntrer les valeurs suivantes :\n  Adresse IP de début : 192.168.2.10\n  Adresse IP de fin : 192.168.2.20\n  Longueur : 24\n  Masque de sous-réseau : 255.255.255.0\n  Cliquer sur Suivant :\n{#WS2012_Screenshots/44}\nCliquer sur Suivant :\n{#WS2012_Screenshots/45}\nCliquer sur Suivant :\n{#WS2012_Screenshots/46}\nCocher l\u0026rsquo;option \u0026quot;Oui, je veux configurer ces options maintenant\u0026quot;, et cliquer sur Suivant :\n{#WS2012_Screenshots/47}\nEntrer l\u0026rsquo;adresse IP 192.168.2.1, puis cliquer sur Ajouter. Ensuite, cliquer sur Suivant :\n{#WS2012_Screenshots/48}\nRemplir les champs comme sur la figure suivante :\n  Domaine parent : EPITAF\n  Nom du serveur : Controleur de domain\n  Adresse IP : 192.168.2.2 et 8.8.8.8\n  Cliquer sur Suivant :\n{#WS2012_Screenshots/49}\nCliquer sur Suivant :\n{#WS2012_Screenshots/50}\nCocher l\u0026rsquo;option \u0026quot;Oui, je veux activer cette étendue maintenant\u0026quot;, puis cliquer sur Suivant :\n{#WS2012_Screenshots/51}\nCliquer sur Terminer :\n{#WS2012_Screenshots/52}\nCréation de l\u0026rsquo;Active Directory Cliquer sur Outils, puis cliquer sur Centre d\u0026rsquo;administration Active Directory :\n{#WS2012_Screenshots/53}\nDans l\u0026rsquo;encadré Serveurs, cliquer sur Autres... :\n{#WS2012_Screenshots/54}\nCliquer sur l\u0026rsquo;action Promouvoir ce serveur en contrôleur de domaine :\n{#WS2012_Screenshots/55}\nAller dans la section Configuration de déploiement :\n{#WS2012_Screenshots/56}\nCocher l\u0026rsquo;option \u0026quot;Ajouter une nouvelle forêt\u0026quot;, et entrer la valeur \u0026quot;EPITAF.local\u0026quot; dans le champ Nom de domaine racine. Cliquer sur Suivant :\n{#WS2012_Screenshots/58}\nAller dans la section Options du contrôleur de domaine. Entrer un mot de passe respectant les bonne pratiques de sécurité, puis cliquer sur Suivant :\n{#WS2012_Screenshots/59}\nAller dans la section Options DNS, puis cliquer sur Suivant :\n{#WS2012_Screenshots/60}\nAller dans la section Options supplémentaires, puis cliquer sur Suivant :\n{#WS2012_Screenshots/61}\nAller dans la section Chemins d\u0026rsquo;accès, puis cliquer sur Suivant :\n{#WS2012_Screenshots/62}\nAller dans la section Examiner les options, puis cliquer sur Suivant :\n{#WS2012_Screenshots/63}\nAller dans la section Vérification de la configuration requise, puis cliquer sur Installer :\n{#WS2012_Screenshots/64}\nUne fois le serveur redémarré, se connecter au compte administrateur du domaine EPITAF.\n{#WS2012_Screenshots/65}\nDans le gestionnaire de serveur, aller dans la section DHCP via la colonne de gauche. Cliquer sur Autres... dans l\u0026rsquo;encart jaune :\n{#WS2012_Screenshots/66}\nCliquer sur l\u0026rsquo;action \u0026quot;Terminer la configuration DHCP\u0026quot; :\n{#WS2012_Screenshots/67}\nDans la section Description cliquer sur Suivant :\n{#WS2012_Screenshots/68}\nDans la section Autorisation, cocher l\u0026rsquo;option \u0026quot;Utiliser les informations d\u0026rsquo;identification de l\u0026rsquo;utilisateur suivant\u0026quot;, pour l\u0026rsquo;utilisateur EPITAF\\Administrateur. Cliquer sur Valider :\n{#WS2012_Screenshots/69}\nDans la section Résumé cliquer sur Fermer :\n{#WS2012_Screenshots/70}\nCliquer sur Outils, puis cliquer sur DHCP. Ensuite, dérouler la section IPv4, et cliquer droit sur Options de serveur, puis cliquer sur Configurer les options... :\n{#WS2012_Screenshots/71}\nCocher l\u0026rsquo;option 003 Routeur. Dans le champ Adresse IP, entrer l\u0026rsquo;adresse IP 192.168.2.1, puis cliquer sur Ajouter :\n{#WS2012_Screenshots/72}\nCocher l\u0026rsquo;option 006 Servers DNS. Dans le champ Adresse IP, entrer l\u0026rsquo;adresse IP 192.168.2.2, puis cliquer sur Ajouter. Enfin, cliquer sur OK :\n{#WS2012_Screenshots/73}\nAjout d\u0026rsquo;un utilisateur dans le domaine EPITAF Pour ajouter en toute sécurité un utilisateur dans notre domaine EPITAF, nous allons :\n  Depuis le Gestionnaire de serveur, cliquer sur Outils puis sur Utilisateurs et ordinateurs AD ;\n  Dérouler le menu comme suit : Utilisateurs et ordinateurs AD -\u0026gt; EPITAF.local -\u0026gt; Users, cliquer droit sur Users. Dans le menu Nouveau cliquer sur Utilisateur ;\n  Renseigner les champs puis cliquer sur Suivant ;\n  Renseigner le mot de passe de l\u0026rsquo;utilisateur puis cliquer sur Suivant ;\n  Vérifier les informations puis cliquer sur Terminer.\n  Ajout d\u0026rsquo;un ordinateur dans le domaine EPITAF Pour ajouter un ordinateur dans le domaine EPITAF, il faut :\n  Dérouler le menu comme suit : Utilisateurs et ordinateurs AD -\u0026gt; EPITAF.local -\u0026gt; Computers, cliquer droit sur Computers. Dans le menu Nouveau cliquer sur Ordinateur ;\n  Remplir les champs adéquats puis cliquer sur Modifier... ;\n  Renseigner le nom de l\u0026rsquo;utilisateur précédemment créé puis cliquer sur OK ;\n  Cliquer sur OK :\n  Windows Attribution des paramètres réseaux Démarrer la machine virtuelle Windows 10. Accéder aux paramètres réseau et Internet, en cliquant droit sur l\u0026rsquo;icône de réseau sur la droite de la barre des tâches. Cliquer sur Ouvrir les paramètres réseau et Internet :\n{#W_Screenshots/41}\nOuvrir les options d\u0026rsquo;adaptateur, en cliquant sur Modifier les options d\u0026rsquo;adapteur :\n{#W_Screenshots/42}\nCliquer droit sur la carte Ethernet, et sélectionner Propriétés :\n{#W_Screenshots/43}\nDécocher Protocole Internet version 6 (TCP/IPv6), et cocher Protocole Internet version 4 (TCP/IPv4). Cliquer sur Propriétés pour IPv4 :\n{#W_Screenshots/44}\nRenseigner la valeur du serveur DNS préféré : 192.168.2.2. Cliquer sur OK :\n{#W_Screenshots/45}\nAttribution du domaine Accéder aux paramètres Systèmes :\n{#W_Screenshots/46}\nAller à la section Informations Système. Cliquer sur Informations système :\n{#W_Screenshots/47}\nCliquer sur Modifier les paramètres :\n{#W_Screenshots/48}\nAccéder aux propriétés de domaine en cliquant sur Modifier :\n{#W_Screenshots/49}\nAjouter le domaine EPITAF, et cliquer sur OK :\n{#W_Screenshots/50}\nRentrer les identifiants demandés, par exemple :\n  Nom d\u0026rsquo;utilisateur : EPITAF\\Ultrae;\n  Mot de passe : celui associé à Ultrae.\n  Un message de bienvenue apparaît si les identifiants sont corrects. Cliquer sur OK puis fermer toutes les fenêtres :\n{#W_Screenshots/51}\nDebian Attribution des paramètres réseaux Sur VirtualBox, sélectionner la machine virtuelle \u0026quot;Debian DM4\u0026quot;, et cliquer sur Configuration :\n{#Debian_screenshots/Config/1}\nAccéder à la section Réseau, puis dans l\u0026rsquo;onglet \u0026quot;Interface 1\u0026quot;, sélectionner Réseau interne comme mode d\u0026rsquo;accès réseau, avec \u0026quot;pfsense\u0026quot; comme nom :\n{#Debian_screenshots/Config/2}\nSe connecter sur la machine virtuelle. Cliquer sur l\u0026rsquo;icône pour les réseaux, cliquer sur Connexion de Filaire en ..., puis sur Paramètres filaires :\n{#Debian_screenshots/Config/3}\nSélectionner Filaire, puis cliquer sur le bouton des paramètres :\n{#Debian_screenshots/Config/4}\nAller dans la section IPv4, puis sélectionner Manuel afin de configurer les adresses suivantes : 192.168.2.2, 255.255.255.0 et 192.168.2.1. Cliquer sur Appliquer :\n{#Debian_screenshots/Config/5}\nOuvrir un navigateur, et se rendre à l\u0026rsquo;adresse \u0026quot;https://192.168.2.1\u0026quot; :\n{#Debian_screenshots/Config/6}\nOuvrir la fenêtre de configuration de la machine virtuelle de pfsense, et aller dans la section Réseau. Se rendre dans l\u0026rsquo;onglet \u0026quot;Interface 3\u0026quot;, cocher \u0026quot;Activer l\u0026rsquo;interface réseau\u0026quot;, sélectionner Réseau interne comme mode d\u0026rsquo;accès réseau, avec pour nom \u0026quot;dmz\u0026quot;. Cliquer sur OK :\n{#Debian_screenshots/Config/7}\nSur la page web de configuration de pfsense, cliquer sur Interfaces puis Assignments :\n{#Debian_screenshots/Config/8}\nCliquer sur le bouton Add :\n{#Debian_screenshots/Config/9}\nCliquer sur la nouvelle interface créée, soit OPT1 :\n{#Debian_screenshots/Config/10}\nRemplir les champs comme sur la figure ci-dessous :\n{#Debian_screenshots/Config/11}\nCliquer sur le bouton Apply Changes une fois les champs remplis :\n{#Debian_screenshots/Config/12}\nCliquer sur Firewall, puis sur Rules :\n{#Debian_screenshots/Config/13}\nSélectionner la première règle ainsi que les deux dernières (d\u0026rsquo;après la figure suivante), puis cliquer sur le bouton Delete :\n{#Debian_screenshots/Config/14}\nVérifier que la configuration des règles de pfsense soit la même que celle de la figure ci-dessous :\n{#Debian_screenshots/Config/15}\nCliquer sur l\u0026rsquo;icône pour les réseaux dans le coin haut-droite de la machine, puis cliquer sur Paramètres filaire :\n{#Debian_screenshots/Config/16}\nAller dans la section IPv4, puis sélectionner Manuel afin de configurer les adresses suivantes : 192.168.3.2, 255.255.255.0 et 192.168.3.1. Cliquer sur Appliquer :\n{#Debian_screenshots/Config/17}\nOuvrir la fenêtre de configuration réseau de la machine virtuelle Debian. Aller dans la section Réseau, puis dans l\u0026rsquo;onglet \u0026quot;Interface 1\u0026quot;, changer le nom à \u0026quot;dmz\u0026quot;, puis cliquer sur OK :\n{#Debian_screenshots/Config/18}\nInterception SSL/TLS Objectifs L\u0026rsquo;objectif, comme le montre la figure ci-dessous (250{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Schema_tls/1\u0026rdquo;}), est :\n  de pouvoir lire les informations transitant entre deux entités utilisant une connexion SSL/TLS ;\n  de pouvoir filtrer le mot clé EPITA dans le contenu chargé.\n  La présente section décrit donc comment obtenir ce résultat en utilisant le proxy SQUID avec l\u0026rsquo;antivirus intégré ClamAV via le pare-feu pfSense.\n{#Schema_tls/1}\nAccès à Pfsense et installation des paquets Pour pouvoir obtenir SQUID il faut :\n  Se connecter à Pfsense via Internet Explorer\n  Accéder à System -\u0026gt; Package Manager :\n[[Pfsense_Screeshots/interception/3]]{#Pfsense_Screeshots/interception/3 label=\u0026ldquo;Pfsense_Screeshots/interception/3\u0026rdquo;}\n  Cliquer sur Available Packages :\n[[Pfsense_Screeshots/interception/4]]{#Pfsense_Screeshots/interception/4 label=\u0026ldquo;Pfsense_Screeshots/interception/4\u0026rdquo;}\n  Rechercher SQUID :\n[[Pfsense_Screeshots/interception/5]]{#Pfsense_Screeshots/interception/5 label=\u0026ldquo;Pfsense_Screeshots/interception/5\u0026rdquo;}\n  Cliquer sur Install\n  Cliquer sur Confirm :\n[[Pfsense_Screeshots/interception/6]]{#Pfsense_Screeshots/interception/6 label=\u0026ldquo;Pfsense_Screeshots/interception/6\u0026rdquo;}\n  Attendre la fin de l\u0026rsquo;installation.\n[[Pfsense_Screeshots/interception/7]]{#Pfsense_Screeshots/interception/7 label=\u0026ldquo;Pfsense_Screeshots/interception/7\u0026rdquo;}\n[[Pfsense_Screeshots/interception/8]]{#Pfsense_Screeshots/interception/8 label=\u0026ldquo;Pfsense_Screeshots/interception/8\u0026rdquo;}\n  Ajout d\u0026rsquo;un certificat Pour ajouter un certificat, il faut :\n  accéder à System -\u0026gt; Certificat Manager -\u0026gt; CAs ;\n  cliquer sur Add;\n[[Pfsense_Screeshots/interception/9]]{#Pfsense_Screeshots/interception/9 label=\u0026ldquo;Pfsense_Screeshots/interception/9\u0026rdquo;}\n  renseigner les champs comme ci-dessous :\n[[Pfsense_Screeshots/interception/10]]{#Pfsense_Screeshots/interception/10 label=\u0026ldquo;Pfsense_Screeshots/interception/10\u0026rdquo;}\n  Ajout du certificat sur tous les postes appartenant à EPITAF via GPO Afin d\u0026rsquo;intercepter tous les flux provonant du réseau couvert par le domaine EPITAF, voici comment propager le certificat CA à tous les membres du domaine EPITAF :\n  Depuis le tableau de bord, cliquer sur Outils puis cliquer sur Gestion des politiques de groupe ;\n  Dérouler le menu comme suit : Gestion de stratégie de groupe -\u0026gt; Forêt : EPITAF.local -\u0026gt; Domaines -\u0026gt; EPITAF.local -\u0026gt; Objets de stratégie de groupe puis cliquer sur Nouveau ;\n  Indiquer le nom de la GPO et cliquer sur OK ;\n  Cliquer droit sur la nouvelle GPO puis cliquer sur Modifier... ;\n  Dérouler le menu comme suit : Stratégie AC pour IE -\u0026gt; Configuration -\u0026gt; Paramètres Windows -\u0026gt; Paramètres de sécurité -\u0026gt; Stratégie de clé publique puis cliquer droit sur Autorité de certification racines de confiance ;\n  Cliquer sur Importer... ;\n  Cliquer sur Suivant ;\n  Cliquer sur Parcourir... ;\n  choisir le certificat puis cliquer sur Suivant ;\n  Cliquer sur Suivant ;\n  Cliquer sur Terminer ;\n  Cliquer sur Ok.\n  Mise en place de l\u0026rsquo;antivirus ClamAV Pour mettre en place l\u0026rsquo;antivirus ClamAV, il faut :\n  Accéder à Services -\u0026gt; Squid Proxy Server ;\n[[Pfsense_Screeshots/interception/11]]{#Pfsense_Screeshots/interception/11 label=\u0026ldquo;Pfsense_Screeshots/interception/11\u0026rdquo;}\n  Changer la valeur du cache par 500, puis cliquer sur save ;\n[[Pfsense_Screeshots/interception/12]]{#Pfsense_Screeshots/interception/12 label=\u0026ldquo;Pfsense_Screeshots/interception/12\u0026rdquo;}\n  Cocher Enable AV, mettre Enable Manual Configuration à enabled, cliquer sur Load Advanced ;\n[[Pfsense_Screeshots/interception/13]]{#Pfsense_Screeshots/interception/13 label=\u0026ldquo;Pfsense_Screeshots/interception/13\u0026rdquo;}\n  Ouvrir la configuration avancée puis lire la valeur DatabaseDirectory dans freshclam.conf.\n[[Pfsense_Screeshots/interception/14]]{#Pfsense_Screeshots/interception/14 label=\u0026ldquo;Pfsense_Screeshots/interception/14\u0026rdquo;}\n  \u0026lt;!-- --\u0026gt;   Accéder à Services -\u0026gt; Squid Proxy Server ;\n  Cocher Enable Squid Proxy, cocher Keep Settings/Data, mettre Proxy Interface(s) à LAN, cliquer sur Load Advanced ;\n  Cocher Transparent HTTP Proxy ;\n[[Pfsense_Screeshots/interception/15]]{#Pfsense_Screeshots/interception/15 label=\u0026ldquo;Pfsense_Screeshots/interception/15\u0026rdquo;}\n  Cocher HTTPS/SSL Interception ;\n  Cocher Enable Access Logging ;\n  Cliquer sur save ;\n[[Pfsense_Screeshots/interception/16]]{#Pfsense_Screeshots/interception/16 label=\u0026ldquo;Pfsense_Screeshots/interception/16\u0026rdquo;}\n  Comme fait précédemment, ajouter une règle sur pfsense ;\n[[Pfsense_Screeshots/interception/17]]{#Pfsense_Screeshots/interception/17 label=\u0026ldquo;Pfsense_Screeshots/interception/17\u0026rdquo;}\n  Paramétrer la configuration pour autoriser les ports 3128 et 3129, puis cliquer sur save;\n[[Pfsense_Screeshots/interception/18]]{#Pfsense_Screeshots/interception/18 label=\u0026ldquo;Pfsense_Screeshots/interception/18\u0026rdquo;}\n  Pour interdire tous les navigateurs sauf Internet Explorer en version supérieure à 10, il faut ajouter la regex présentée ci-dessous dans l\u0026rsquo;onglet ACLs, à Block User Agents.\n[[Pfsense_Screeshots/interception/19]]{#Pfsense_Screeshots/interception/19 label=\u0026ldquo;Pfsense_Screeshots/interception/19\u0026rdquo;}\n  Filtrage du mot clé EPITA via ClamAV Pour pouvoir filtrer tous les paquets contenant le mot clé EPITA avec SQUID, nous utiliserons l\u0026rsquo;anti-virus intégré : ClamAV.\nLorsque clamAV détecte une page web en entrée, à l\u0026rsquo;aide d\u0026rsquo;une balise HTML valide, il se comporte comme suit [@Clamav-signatures] :\n  le fichier est normalisé, les commentaires sont supprimés, tout est mis en minuscule et les espaces en trop sont supprimés ;\n  les tags HTML sont enlevés ;\n  un fichier contenant le javascript est créé.\n  Nous cherchons donc à créer une signature permettant de détecter le mot clé EPITA et donc nous notifier. Pour cela, plusieurs formats se présentent à nous. Nous en retiendrons deux :\n  les .yara [@yara-signatures] [@yara-hunting-signatures];\n  les .ndb[@ndb-signatures].\n  Ainsi, après avoir lu où se trouve les signatures de ClamAV via les fichiers de configuration de SQUID, nous rajouterons les notres (voir dev.pdf pour le contenu) dans le dossier adéquat.\nCi-dessous, le résultat après une recherche google avec des termes proches d\u0026rsquo;epita.\n[[Pfsense_Screeshots/interception/18]]{#Pfsense_Screeshots/interception/18 label=\u0026ldquo;Pfsense_Screeshots/interception/18\u0026rdquo;}\n[[Pfsense_Screeshots/interception/18]]{#Pfsense_Screeshots/interception/18 label=\u0026ldquo;Pfsense_Screeshots/interception/18\u0026rdquo;}\nCe qui nous donne dans les logs :\n[[Pfsense_Screeshots/interception/18]]{#Pfsense_Screeshots/interception/18 label=\u0026ldquo;Pfsense_Screeshots/interception/18\u0026rdquo;}\nMise en place d\u0026rsquo;une connexion SSL/TLS mutualisée Objectifs et pré-requis Nous cherchons ici à établir une connexion SSL/TLS mutualisée.\nPour cela, nous considérons sur le serveur possédant le serveur TLS que :\n  le serveur est une machine virtuelle hébergée dans le Cloud de Google ;\n  l\u0026rsquo;OS utilisé est un Debian 64 ;\n  le serveur Nginx est déjà installé mais pas encore configuré ;\n  le nom de domaine utilisé est ultrae.eu ;\n  le site web est déjà créé dans /var/www/html/.\n  Paramétrage du serveur NGINX Pour pouvoir paramétrer nginx il faut :\n  Générer à l\u0026rsquo;aide du pki (voir dev.pdf) :\n  un certificat CA et sa clé privée ;\n  un CSR signé par le CA.\n    Les placer dans un dossier sur le serveur distant.\n  Dans la configuration ssl de Nginx rajouter les lignes :\n  ssl_certificate \u0026quot;/etc/nginx/cert/ultrae.eu.CA.crt\u0026quot;;\n  ssl_certificate_key \u0026quot;/etc/nginx/cert/ultrae.eu.CA.key\u0026quot;;\n  ssl_client_certificate \u0026quot;/etc/nginx/cert/ultrae.eu.crt\u0026quot;;\n  ssl_verify_client on.\n    Ajouter dans le navigateur :\n  le certificat du CA dans les certificats root trusted ;\n  le certificat client dans les certificats personnels.\n    Interception SSL/TLS sur une connexion TLS mutualisée Afin de pouvoir intercepter et pouvoir déchiffrer un flux chiffré entre un serveur TLS et un client s\u0026rsquo;authentifiant mutuellement, il faut :\n  Se connecter sur pfsense ;\n  Dans System -\u0026gt; Cert. Manager, importer un CA ;\n  Dans l\u0026rsquo;onglet Certificates, importer un CSR ;\n  Ajouter un nouveau certificat, selectionner la méthode Sign a Certificate Signing Request;\n  Mettre ultrae.eu dans Descriptive name ;\n  Mettre ultrae.eu.CA dans CA to sign ;\n  Mettre sha512 dans Digest Algorithm ;\n  Mettre URI et www.ultrae.eu dans Alternative Names ;\n  Cliquer sur save.\n  -\nInstallation et configuration des services Ansible Pour pouvoir construire notre infrastructure 251{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Architecture_Screenshots/2\u0026rdquo;}, nous utiliserons Ansible 1.\n{#Architecture_Screenshots/2}\nAfin de lancer le déploiement, il suffit d\u0026rsquo;exécuter la commande suivante à partir d\u0026rsquo;une machine présente dans le LAN :\n$ ansible-playbook -i hosts full.yml --ask-pass --ask-vault Si Ansible n\u0026rsquo;est pas installé sur la machine lançant le script, il faudra :\n  Ajouter à deb http://ppa.launchpad.net/ansible/ansible/ubuntu trusty main à :\n/etc/apt.source.list\n  Il faudra ensuite exécuter ces commandes pour mettre en place Ansible :\n$ sudo apt-key adv \\  --keyserver keyserver.ubuntu.com \\  --recv-keys 93C4A3FD7BB9C367 $ sudo apt update $ sudo apt install ansible   Nginx Paquets installés Les paquets nécessaires au fonctionnement du service web Nginx sont:\n  nginx\n  nginx-extras afin de pouvoir modifier le header et diminuer l\u0026rsquo;empreinte numérique\n  {#Nginx_Screenshots/4.png}\nRôle Ce rôle Ansible permet de déployer automatiquement un service web Nginx, clé en main. Les principales étapes sont les suivantes:\n  Modification du fichier de configuration situé dans /etc/nginx/nginx.conf:\n  Ajout de more_set_headers \u0026lsquo;Server: WeAreAnonymous\u0026rsquo; et server_tokens off\n  Journalisation des événements en ajoutant access_log /var/log/nginx/access.log et error_log /var/log/nginx/error.log\n    Création de plusieurs pages html personnalisées, notamment pour gérer les erreurs 404, 405 et 50x. Le but est de limiter au maximum l\u0026rsquo;identité du service qui est dévoilée avec les pages par défaut.\n  Ecoute sur le port 443 en plus du 80 :\n  listen 443 ssl default_server; listen [::]:443 ssl default_server;   Redirection automatique des requêtes sur le port 80 vers le port 443\n  Ajout d\u0026rsquo;une politique de protection :\n  add_header Strict-Transport-Security \u0026#34;max-age=31536000; includeSubdomains\u0026#34; always; add_header X-Xss-Protection \u0026#34;1; mode=block\u0026#34; always; add_header X-Frame-Options \u0026#34;SAMEORIGIN\u0026#34; always; add_header X-Content-Type-Options \u0026#34;nosniff\u0026#34; always; add_header Referrer-Policy \u0026#34;no-referrer-when-downgrade\u0026#34;; Politique de sécurité CSP filtrant le contenu : add_header Content-Security-Policy \u0026#34;default-src \u0026#39;self\u0026#39; [...] Autorisation des requêtes GET et POST seulement : if ( \\$reques_method !~ ^(GET|POST)\\$ ) { return 405; }  Ajout des certificats générés par la PKI du DM3 :  ssl_certificate /etc/nginx/server.crt; ssl_certificate_key /etc/nginx/server.key; ssl_client_certificate /etc/nginx/CAcrt.pem; L\u0026rsquo;utilisateur devra ensuite se connecter avec le certificat p12 utilisateur, émis par la PKI.\n{#Nginx_Screenshots/5.png}\n{#Nginx_Screenshots/6.png}\n{#Nginx_Screenshots/7.png}\n{#Nginx_Screenshots/8.png}\n{#Nginx_Screenshots/9.png}\nMySQL Paquets installés Les paquets nécessaires au fonctionnement de MariaDB (MySQL) sont:\n  mysql-server\n  php-mysql\n  python-mysqldb\n  Rôle Ce rôle Ansible permet de déployer automatiquement la base de données MariaDB (MySQL). Cette base servira au site wordpress joué par le service Apache2. Ce rôle décrit une commande autonome, mais interactive toute simple : mysql_secure_installation. Cette commande doit être lancée en tant que root.\n{#Wordpress_Screenshots/5.png}\nCette commande exécute plusieurs tâches notamment:\n  Changement du mot de passe root de la DB\n  Désactivation de l\u0026rsquo;authentification root à distance\n  Suppression des utilisateurs anonymes\n  Suppression de la base test\n  Suppression des privilèges de la base test\n  Bien entendu, cette commande a été reprise en détails dans un rôle ansible afin de produire le même comportement.\nApache Paquets installés Les paquets nécessaires au fonctionnement du serveur Apache sont:\n  apache2\n  php\n  libapache2-mod-php\n  krb5-user\n  libapache2-mod-auth-kerb\n  libapache2-modsecurity\n  php-curl\n  php-gd\n  php-intl\n  php-json\n  php-mbstring\n  php-xml\n  php-zip\n  Rôle Ce rôle Ansible permet de déployer automatiquement le service web Apache2 prêt à être utilisé, mais aussi le support de l\u0026rsquo;authentification via Kerberos.\nPour une installation manuelle d\u0026rsquo;Apache, les étapes de déploiement sont les suivantes :\n  Installer les paquets avec un gestionnaire de paquets;\n  Démarrer le service Apache.\n  Une fois qu\u0026rsquo;Apache est fonctionnel, il faut installer le blog Wordpress demandé. Il suffit pour cela de cloner le dépôt WordPress suivant https://github.com/WordPress/WordPress.git, dans /var/www/html/wordpress, afin de pouvoir accéder au site via la boucle locale soit https://192.168.3.2/blog.\nEn démarrant Wordpress, il faut avoir Apache, PHP et MariaDB en route et configuré. Dans un second temps, il faudra se connecter à MariaDB afin d\u0026rsquo;y créer une table et un utilisateur.\nSur Wordpress, un assistant reprenant tous les éléments configurés nous guidera afin de générer le fichier wp-config.php qui sera à mettre dans le dossier wordpress cité plus haut.\nLors de la première connexion, il faudra remplir le formulaire de création d\u0026rsquo;un administrateur du site, selon l\u0026rsquo;illustration suivante :\n{#Wordpress_Screenshots/1.png}\nÀ l\u0026rsquo;étape suivante, il suffit de cliquer sur \u0026quot;Log In\u0026quot; pour se connecter à l\u0026rsquo;interface administrateur de gestion du site.\n{#Wordpress_Screenshots/2.png}\nSoyez les bienvenus sur Wordpress !\n{#Wordpress_Screenshots/4.png}\nOpenSSH Paquets installés   openssh-server\n  libpam-google-authenticator\n  Rôle Gestion des utilisateurs La liste ci-dessous détaille et explique les commandes à réaliser concernant la gestion des utilisateurs :\n  Création du groupe TOPGUN : sudo groupadd TOPGUN{.bash}\n  Création de l\u0026rsquo;utilisateur maverik : sudo useradd maverik{.bash}\n  Création de l\u0026rsquo;utilisateur charlie : sudo useradd charlie{.bash}\n  Création de l\u0026rsquo;utilisateur goose : sudo useradd goose{.bash}\n  Ajout de maverik au groupe TOPGUN : sudo usermod -g TOPGUN maverik{.bash}\n  Ajout de charlie au groupe TOPGUN : sudo usermod -g TOPGUN charlie{.bash}\n  Ajout de goose au groupe TOPGUN : sudo usermod -g TOPGUN goose{.bash}\n  Aussi, les utilisateurs maverik et charlie ne connaissent pas leur mot de passe ; ceux-ci sont stockés dans un coffre. Étant donné que nous avons utilisé un coffre pour certaines variables des playbooks Ansible, nous avons trouvé plus simple d\u0026rsquo;utiliser ce coffre-là pour y stocker les mots de passe de maverik et Charlie. Nous avons pour cela utilisé l\u0026rsquo;outil Ansible Vault.\nAttribution de droits Une fois que les utilisateurs ont été créés, il est possible de leur attribuer certains droits. En effet :\n  maverik doit pouvoir redémarrer le système ou le mettre à jour en tant que utilisateur privilégié;\n  charlie doit pouvoir effectuer toutes les tâches root sur le système;\n  goose n\u0026rsquo;a auncun droit de ce type.\n  Ces configurations se font dans le fichier /etc/sudoers. Afin de faciliter l\u0026rsquo;ajout de configurations particulières, il est possible de rajouter ses propres fichiers. C\u0026rsquo;est ce que nous avons fait, car cela permet aussi un déploiement par Ansible plus simple. Ainsi, nous avons créé le fichier /etc/sudoers.d/ssh-users, qui contient :\n  Le temps pendant lequel un utilisateur ayant utilisé sudo n\u0026rsquo;a pas besoin de se ré-authentifier pour exécuter des commandes nécessitant sudo;\n  L\u0026rsquo;attribution des droits pour maverik;\n  L\u0026rsquo;attribution des droits pour charlie.\n  Ce fichier doit appartenir à l\u0026rsquo;utilisateur root, et posséder les permissions suivantes : \u0026quot;0440\u0026quot; ; on les lui donne avec sudo chmod 0440 /etc/sudoers.d/ssh-users{.bash}.\nGoogle Authenticator Dans la configuration SSH attendue, il est demandé de permettre l\u0026rsquo;authentification via Google Authenticator. Afin de l\u0026rsquo;utiliser, il faut tout d\u0026rsquo;abord installer le paquet libpam-google-authenticator. Ensuite, lancer la génération de la clé secrète avec google-authenticator{.bash} pour chacun des utilisateurs, qui sera exécuté de manière interactive. Plusieurs questions sont en effet posées, telles que le montrent les figures suivantes :\nIl est préférable d\u0026rsquo;accepter que les jetons d\u0026rsquo;authentification soient basés sur le temps.\n{#OpenSSH_Screenshots/google-auth-1.png}\nAffichage du QR Code à flasher avec l\u0026rsquo;application Google Authenticator, ainsi que de la clé secrète à entrer dans l\u0026rsquo;application Google Authenticator s\u0026rsquo;il n\u0026rsquo;est pas possible de la flasher maintenant. Google authenticator donne également cinq codes récupération en cas de perte ou de vol du téléphone possédant l\u0026rsquo;application Google authenticator. Si le fichier /home/\u0026lt;user\u0026gt;/.google_authenticator existe déjà, il est possible de le templacer par la nouvelle clé secrète\n{#OpenSSH_Screenshots/google-auth-2.png}\nChoisir de ne pas autoriser l\u0026rsquo;utilisation multiple du même jeton d\u0026rsquo;authentification.\n{#OpenSSH_Screenshots/google-auth-3.png}\nGarder la génération d\u0026rsquo;un nouveau jeton toutes les 30 secondes, et donc répondre non à la question :\n{#OpenSSH_Screenshots/google-auth-4.png}\nRépondre oui pour permettre la limitation de tentative de connexion :\n{#OpenSSH_Screenshots/google-auth-5.png}\nCe programme génère un fichier .google_authenticator contenant la clé secrète à donner à l\u0026rsquo;application Google Authenticator, dans le dossier /home/\u0026lt;user\u0026gt;/ de l\u0026rsquo;utilisateur actuel. Cette clé est utile si l\u0026rsquo;utilisateur n\u0026rsquo;a pas pu récupérer le QR Code affiché à l\u0026rsquo;écran.\nCette étape \u0026quot;Google Authenticator\u0026quot; se déroule donc en deux temps : la génération de la clé secrète et son ajout dans l\u0026rsquo;application Google Authenticator, ce qui rend difficile le déploiement avec Ansible. En effet, la difficulté est ici la récupération des clés générées et leur distribution aux bons utilisateurs. La solution qui nous a semblé la plus appropriée est la suivante :\n  Copier le fichier .google_authenticator pour chacun des utilisateurs dans le dossier d\u0026rsquo;où est lancé le déploiement par Ansible. Ils sont ajoutés au dossier GoogleAuthenticator situé au niveau du fichier hosts;\n  L\u0026rsquo;administrateur à l\u0026rsquo;origine du déploiement peut ensuite distribuer de manière sécurisée ces fichiers aux utilisateurs concernés.\n  Aussi, nous avons utilisé Google Authenticator en mode non-interactif dans le playbook Ansible, contrairement à l\u0026rsquo;exemple montré sur les figures ci-dessus, où Google Authenticator est utilisé en mode interactif.\nUne fois les clés secrètes générées, il faut permettre leur utilisation. Il faut pour cela modifier les fichiers de PAM - Pluggable Authentication Modules.\nPAM Le comportement attendu est de pouvoir se connecter en SSH en utilisant un code généré par Google Authenticator pour certains utilisateurs. Pour faire cela, il faut modifier le fichier /etc/pam.d/sshd, en tant qu\u0026rsquo;utilisateur privilégié. Il faut pour cela commenter la ligne @include common-auth{.bash}, et ajouter la ligne suivante à la fin du fichier : auth required pam_google_authenticator.so{.bash}\nAfin que SSH demande cette méthode d\u0026rsquo;authentification, il faut modifier le fichier de configuration du serveur SSH, qui est le fichier /etc/ssh/sshd_config. Il faut éditer ce fichier en tant qu\u0026rsquo;utilisateur privilégié.\ncharlie Aussi, l\u0026rsquo;utilisateur charlie peut effectuer toutes les tâches root sur le système, mais doit se ré-authentifier toutes les 15 minutes avec un code de vérification de Google Authenticator. La figure ci-dessous montre que charlie peut effectuer toute sorte de commande utilisant sudo{.bash}, sans redemander le code de vérification. Au bout de 15 minutes, charlie doit entrer le code de vérification de Google Authenticator :\n{#OpenSSH_Screenshots/maverik.png}\nPour des raisons pratiques, la capture d\u0026rsquo;écran montre le comportement attendu avec un timeout de 1 minute.\nIl faut tout d\u0026rsquo;abord ajouter au fichier /etc/sudoers.d/ssh-users créé précedemment, la ligne : Defaults:charlie timestamp_timeout=15{.bash}\nEnsuite, il faut configurer PAM pour sudo, via le fichier de configuration /etc/pam.d/sudo. Le fichier est affiché ci-dessous :\n#%PAM-1.0 auth [success=ignore default=1] pam_succeed_if.so user ingroup charlie-grp auth sufficient pam_google_authenticator.so nullok @include common-auth @include common-account @include common-session-noninteractive Pour que cette fonctionnalité soit opérationnelle, il faut créer un groupe charlie-grp, auquel appartient charlie.\nConfiguration de SSH La configuration du serveur SSH se situe dans le fichier /etc/ssh/sshd_config. C\u0026rsquo;est donc ce fichier que nous avons dû modifier pour répondre aux conditions requises. La liste ci-dessous détaille les mots-clés choisis ainsi que leur(s) argument(s), pour chacun des points demandés :\n Le service écoute uniquement sur le port 22 en IPv4 :  Port 22 Protocol 2 AddressFamily inet ListenAddress 0.0.0.0   Refus des connexions root : PermitRootLogin no{.bash}\n  Le service log au maximum les interactions et surtout les échecs synonymes d\u0026rsquo;incidents de sécurité : LogLevel VERBOSE{.bash}\n  Utilisation du module PAM pour l\u0026rsquo;authentification ; acceptation, uniquement, de l\u0026rsquo;authentification avec biclé ou via un code de sécurité Google Authenticator pour les utilisateurs du serveur :\n  PasswordAuthentication no PermitEmptyPasswords no ChallengeResponseAuthentication yes UsePAM yes # Configuration des méthodes d\u0026#39;authentification # pour certains utilisateurs Match User charlie AuthenticationMethods publickey,keyboard-interactive Match User goose AuthenticationMethods keyboard-interactive Les mots-clés utilisés dans le fichier de configuration que nous avons mis en place ne sont pas tous décrits dans ce document. Ils ont néanmoins été choisis pour avoir une configuration durcie du serveur SSH.\nRésultats attendus Ci-dessous des captures d\u0026rsquo;écran montrant le comportement attendu à la connexion de chacun des utilisateurs : maverik, charlie et goose.\nLa figure ci-dessous montre la connexion SSH de l\u0026rsquo;utilisateur maverik, avec le code de vérification de Google Authenticator. Les commandes apt update{.bash} et sudo apt update{.bash} permettent de montrer que maverik ne peut exécuter que certaines commandes avec sudo{.bash} :\n{#OpenSSH_Screenshots/maverik.png}\nLa figure ci-dessous montre la connexion SSH de l\u0026rsquo;utilisateur charlie, en mode verbose, afin de voir que l\u0026rsquo;authentification se fait grâce à un biclé ainsi que grâce à un code de vérification de Google Authenticator.\n{#OpenSSH_Screenshots/charlie2.png}\nLa figure ci-dessous montre la connexion SSH de l\u0026rsquo;utilisateur goose. Étant donné que cet utilisateur est un stagiaire qui est là pour apprendre les bases des commandes UNIX, il nous a semblé judicieux de lui donner comme shell par défaut un shell restreint : rbash.\n{#OpenSSH_Screenshots/goose.png}\nPare-feu Paquets installés Les paquets nécessaires au fonctionnement du firewall local sont:\n  iptables\n  iptables-persistent\n  Rôle Ce rôle Ansible permet de déployer automatiquement un ensemble de règles consistentes afin de couper le traffic entrant et sortant, sauf aux ports et protocoles des services utilisés.\nParmi les règles, il y a notamment:\n  INPUT\n  DROP ipv6\n  ACCEPT 22/SSH tcp\n  ACCEPT 53/DNS tcp/udp\n  ACCEPT 80/HTTP tcp\n  ACCEPT 443/HTTPS tcp\n  ACCEPT 8000 tcp\n  ACCEPT 10000 tcp\n  ACCEPT ctstate ESTABLISHED,RELATED\n  GOTO LOGGING\n    LOGGING\n  LOG tous les paquets (règle primordiale pour le fonctionnement de fail2ban : se situe juste avant le DROP). Une limite de paquets et de vitesse de réception est appliquée pour ne pas se faire \u0026quot;inonder\u0026quot;;\n  DROP tout ce qui reste\n    OUTPUT\n  REJECT ipv6\n  ACCEPT ctstate ESTABLISHED,RELATED\n  DROP tout ce qui reste\n    Les commandes listées ci-dessous correspondent aux règles décrites dans la liste précedente :\n  iptables -F{.bash}\n  iptables -X{.bash}\n  ip6tables -F{.bash}\n  ip6tables -X{.bash}\n  ip6tables -A INPUT -j DROP{.bash}\n  ip6tables -A OUTPUT -j REJECT{.bash}\n  iptables -A INPUT --dport 22 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 53 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 53 -p udp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 80 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 443 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 8000 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT --dport 10000 -p tcp -j ACCEPT{.bash}\n  iptables -A INPUT -m state --ctstate ESTABLISHED,RELATED -j ACCEPT{.bash}\n  iptables -A OUTPUT -m state --ctstate ESTABLISHED,RELATED -j ACCEPT{.bash}\n  iptables -N LOGGING{.bash}\n  iptables -A LOGGING -j LOG -m limit --limit 1/s --limit-burst 4 --log-prefix \u0026quot;PORT DENIED: \u0026quot; --log-level 6{.bash}\n  iptables -A LOGGING -j DROP{.bash}\n  iptables -A INPUT -g LOGGING{.bash}\n  iptables-save \u0026gt; /etc/iptables/rules{.bash}\n  À chaque enregistrement des règles, une copie est sauvegardée avec la commande : iptables-save \u0026gt; /etc/iptables/rules{.bash}\nCette copie sera utilisée à chaque boot par iptables-persistent pour restaurer l\u0026rsquo;ensemble des règles car iptables oublie les règles par défaut au redémarrage. De cette manière, le filtrage sera permanent.\nFail2ban Paquets installés Le paquet nécessaire au fonctionnement de fail2ban est uniquement fail2ban.\nRôle Ce rôle Ansible permet de déployer le service fail2ban. Ce dernier permet d\u0026rsquo;analyser à l\u0026rsquo;aide de filtres puis de bannir, en cas d\u0026rsquo;infraction des IPs détectées dans les logs suivis.\nLe service bannit les machines qui échouent plusieurs fois lors de:\n  l\u0026rsquo;authentification ssh abusive (3 tentatives);\n  les requêtes HTTP/HTTPS qui ne sont ni GET ni POST (3 tentatives);\n  les scans de port (ban de 5 minutes).\n  Pour ce faire, il faut créer des filtres à mettre dans /etc/fail2ban/filter.d/. Chaque filtre est composé d\u0026rsquo;une failregex, une phrase qui identifie les logs coupables. On peut y rajouter une exclusion à l\u0026rsquo;aide cette fois-ci d\u0026rsquo;une ignoreregex, où les logs qui correspondent sont ignorés. Le fichier de configuration de fail2ban se situe dans /etc/fail2ban/jail.d/defaults-debian.conf. Il contient les scopes des filtres. Le premier est le scope default qui contient le champ ignoreip contenant les machines de confiance. Ensuite, il y a un scope par filtre que l\u0026rsquo;on appelle des plugins. Chacun dispose de différents champs dont :\n  enabled true : activé;\n  filter : nom du filtre utlisé;\n  port : ports surveillés dans le cas des requêtes;\n  logpath /path/to/log : log du service cible utilisé pour la détection;\n  bantime: temps de bannissement;\n  findtime : temps avant réinitialisation de maxretry;\n  maxretry : nombre de fois autorisées avant bannissement.\n  Les illustrations suivantes montrent la configuration à adopter :\n{#Fail2ban_Screenshots/1.png}\n{#Fail2ban_Screenshots/2.png}\n{#Fail2ban_Screenshots/3.png}\n{#Fail2ban_Screenshots4.png}\nMise en place d\u0026rsquo;apache avec Kerberos Objectifs et pré-requis Nous cherchons ici à mettre en place un système d\u0026rsquo;authentification sécurisée via Kerberos 2.\nPour cela, nous considérons que nous avons un serveur Windows 2012 déjà configuré via le présent document.\nCi-dessous, le comportement attendu de kerberos sur notre infrastructure :\n{#Debian_screenshots/Config/5}\nIl faut comprendre :\n  Mot de passe : l\u0026rsquo;utilisateur du domaine EPITAF rentre son mot de passe ;\n  Hash : le mot de passe est ensuite hashé par l\u0026rsquo;un des algorithmes et peut être retrouvé via LSSAS.exe;\n  AS-REQ : la machine de l\u0026rsquo;utilisateur demande un ticket d\u0026rsquo;authentification au serveur windows qui est contrôleur de domaine et KDC;\n  AS-REP : le KDC vérifie les identifiants et renvoie un ticket TGT et une clef de session chiffrés ;\n  TGS-REQ : quand l\u0026rsquo;utilisateur cherchera à se connecter à un service, il enverra son ticket TGT et le nom du service auquel il veut accéder au Windows Server;\n  TGS-REP : le KDC vérifie ensuite le TGT et l\u0026rsquo;accès au service auquel l\u0026rsquo;utilisateur veut accéder. Il renverra un ticket TGS permettant à l\u0026rsquo;utilisateur d\u0026rsquo;accéder au service voulu ;\n  TGS : le client envoie son ticket TGS récemment reçu au serveur pour montrer qu\u0026rsquo;il peut accéder au service ;\n  Data : le serveur fournit le service.\n   Afin de pouvoir mettre en place ce comportement, on devra :\n  Configurer le Windows Server (ktpass, création de services, etc) ;\n  Configurer Apache pour qu\u0026rsquo;il puisse prendre en compte Kerberos ;\n  Configurer les clients qui ne sont pas dans l\u0026rsquo;AD avec krb5-user ;\n  Modifier la configuration des navigateurs internet pour qu\u0026rsquo;ils puissent prendre en compte la négociation kerberos.\n  Configuration de Windows Server Dans Gestionnaire de serveur -\u0026gt; Outils, cliquer sur DNS\n{#Debian_screenshots/Config/5}\nDans DNS -\u0026gt; DC01 -\u0026gt; Zones de recherche directes, cliquer droit sur EPITAF.LOCAL puis cliquer sur Nouvel hôte (A ou AAAA)...\n{#Debian_screenshots/Config/5}\nDans Nom mettre infra01 ; dans Adresse IP mettre 192.168.3.2 ; cliquer sur Ajouter un hôte\n{#Debian_screenshots/Config/5}\nDans Gestionnaire de serveur -\u0026gt; Outils, cliquer sur Centre d\u0026rsquo;administration Active Directory\n{#Debian_screenshots/Config/5}\nDans le centre d\u0026rsquo;administration Active Directory, cliquer droit sur EPITAF (local) puis dans Nouveau, cliquer sur Utilisateur\n{#Debian_screenshots/Config/5}\nDans Prénom mettre apache ; dans Ouverture de session mettre apache ; entrer un mot de passe puis cliquer sur Ok\n{#Debian_screenshots/Config/5}\nEntrer la ligne de commande suivante :\nktpass.exe -princ HTTP/infra01.epitaf.local@EPITAF.LOCAL \\ -mapuser apache@EPITAF.LOCAL -pass * \\ -crypto AES256-SHA1 -ptype KRB5_NT_PRINCIPAL \\ -out C:\\http.keytab Lorsque le prompt le demande, entrer le mot de passe, puis entrer la ligne de commande suivante :\nktpass.exe -princ HTTPS/infra01.epitaf.local@EPITAF.LOCAL \\ -mapuser apache@EPITAF.LOCAL -pass * \\ -crypto AES256-SHA1 -ptype KRB5_NT_PRINCIPAL \\ -out C:\\https.keytab Lorsque le prompt le demande, entrer le mot de passe.\nNous venons de créer le service et mapper l\u0026rsquo;utilisateur apache dessus. La commande nous a généré deux fichiers keytab, essentiels pour qu\u0026rsquo;Apache2 puisse nous fournir le service attendu.\n{#Debian_screenshots/Config/5}\nConfiguration du client Kerberos pour un client hors Active Directory La version client de kerberos pour Windows et linux se trouve ici : https://web.mit.edu/kerberos/dist/. Sur un debian, il suffit d\u0026rsquo;installer le paquet krb5-user :\n$ sudo apt install krb5-user Il suffit ensuite de :\n  Modifier le fichier de configuration /etc/krb5.conf comme présenté dans le fichier template d\u0026rsquo;ansible\n  Utiliser kinit pour obtenir un ticket de l\u0026rsquo;utilisateur voulu\n  Utiliser klist pour vérifier l\u0026rsquo;état du cache\n  Utiliser kvno (optionnel) pour obtenir un TGS du service voulu\n{#Debian_screenshots/Config/5}\n  Pour pouvoir accéder au site hébergé sur INFRA01 via le navigateur web, il faut :\n  Ouvrir Firefox et entrer dans l\u0026rsquo;url : about:config\n{#Debian_screenshots/Config/5}\n  Cliquer sur J\u0026rsquo;accepte le risque et entrer dans la barre de recherche : network.negotiate-auth.trusted-uris ; cliquer ensuite sur network.negotiate-auth.trusted-uris\n{#Debian_screenshots/Config/5}\n  Entrer la valeur 192.168.3.2:1000 et cliquer sur Ok.\n{#Debian_screenshots/Config/5}\n    Entrer dans l\u0026rsquo;url : 192.168.3.2:10000 et appuyer sur Entrée. Le wordpress devrait être accessible.\n{#Debian_screenshots/Config/5}\n  Configuration du serveur Apache avec Kerberos Pour pouvoir utiliser Kerberos avec apache et respecter les contraintes imposées, il faut :\n  Installer libapache2-mod-auth-kerb :\n$ sudo apt install libapache2-mod-auth-kerb   Activer le module auth_kerb :\n$ sudo a2enmod auth_kerb   Ajouter dans la configuration apache :\n\u0026lt;VirtualHost *:10000\u0026gt; ServerAdmin wordpress@localhost DocumentRoot /var/www/html/wordpress/ ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined DirectoryIndex index.php SSLEngine on SSLCertificateFile \u0026#34;/etc/apache2/server.crt\u0026#34; SSLCertificateKeyFile \u0026#34;/etc/apache2/server.key\u0026#34; \u0026lt;Directory \u0026#34;/var/www\u0026#34;\u0026gt; Order deny,allow Deny from all Allow from 192.168.2.0/24 AuthType Kerberos AuthName \u0026#34;Kerberos Auth\u0026#34; KrbAuthRealms EPITAF.LOCAL KrbServiceName HTTPS Krb5Keytab /etc/apache2/https.keytab KrbMethodNegotiate on KrbMethodK5Passwd off KrbVerifyKDC on Require valid-user \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt;   Importer les keytabs https.keytab et http.keytab dans /etc/apache2/\n  Configurer kerberos avec le fichier /etc/krb5.conf.\n  Utiliser les commande :\n$ sudo chown www-data:root /etc/http*.keytab $ sudo chmod 640 /etc/http*.keytab   Redémarrer apache :\n$ sudo systemctl restart apache2   Mise en place d\u0026rsquo;apache Modsecurity Objectifs L\u0026rsquo;objectif est de mettre en place un pare-feu applicatif permettant de protéger les applications de INFRA01 ainsi que de filtrer le mot clef EPITA sur les requêtes POST, PUT et GET. Pour cela nous utiliserons ModSecurity 3 avec Apache2.\nLe pare-feu présente cependant des limites s\u0026rsquo;il est utilisé seul.\nPour palier ce problème, nous utiliserons OWASP Core Set Rule 4.\nLa figure 288{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Apache/modsecurity\u0026rdquo;} montre le fonctionnement de ModSecurity. Cela nous permettra de comprendre comment écrire les règles adéquates.\n{#Apache/modsecurity}\nLe cercle représente le processus de traitement de données d\u0026rsquo;Apache. Les étiquettes sont les phases avec lesquelles on pourra interférer via ModSecurity.\nCe qu\u0026rsquo;il faut comprendre :\n  Phase 1 : cette phase se déroule juste après qu\u0026rsquo;Apache ait fini de lire l\u0026rsquo;en-tête d\u0026rsquo;une requête. Il est possible d\u0026rsquo;influer sur la façon dont la requête va être traitée.\n  Phase 2 : lors de cette phase, le corps de la requête est accessible, il est donc possible d\u0026rsquo;en obtenir les arguments.\n  Phase 3 : cette phase se déroule juste avant que le service envoie les en-têtes de la réponse au client. Il est donc possible d\u0026rsquo;acquérir ce qui a été envoyé au client avant qu\u0026rsquo;il ne le reçoive.\n  Phase 4 : dans cette phase, le corps de la réponse est accessible. Il est possible de détecter des \u0026quot;information disclosure\u0026quot;.\n  Phase 5 : phase avant l\u0026rsquo;entrée d\u0026rsquo;information dans les logs. Il est possible d\u0026rsquo;inspecter les messages d\u0026rsquo;erreurs d\u0026rsquo;apache.\n  Configuration du serveur Apache avec modsecurity Configuration par défaut Pour pouvoir utiliser modsecurity avec apache il faut :\n  Installer libapache2-modsecurity :\n$ sudo apt install libapache2-modsecurity   Activer le module security2 :\n$ sudo a2enmod security2   Changer /etc/modsecurity/modsecurity-default.conf en :\n/etc/modsecurity/modsecurity.conf :\n$ sudo cp /etc/modsecurity/modsecurity-default.conf \\  /etc/modsecurity/modsecurity.conf   Changer dans le fichier; SecRuleEngine DetectionOnly en :\n SecRuleEngine On    Redémarrer apache :\n$ sudo systemctl restart apache2   Changement de la configuration par défaut Certains paramètres sont à modifier, on obtiendra :\n  SecResponseBodyLimitation Reject : par défaut laisse passer les réponses qui ne peuvent pas être inspectées dû à leur taille.\n  SecTmpDir /var/modsecurity/tmp/ : par défaut, écrit les fichiers temporaires dans un endroit accessible à tout le monde (/tmp)\n  SecDataDir /var/modsecurity/persistant/ : par défaut, écrit les fichiers persistants dans un endroit accessible à tout le monde (/tmp)\n  SecAuditEngine On : par défaut ne log que certaines transactions.\n  Il faut ensuite :\n  Créer les dossiers adéquats :\n$ mkdir -p /var/modsecurity/tmp /var/modsecurity/persistant   Redémarrer apache2\n  Filtrage du mot EPITA On cherche à bloquer le mot clé EPITA dans les méthodes GET, PUT et POST. Pour cela il faut rajouter la ligne suivante dans /etc/modsecurity/modsecurity.conf :\nSecRule REQUEST_METHOD \u0026#34;(?:POST|GET|PUT)\u0026#34; \\  \u0026#34;phase:2, t:none, chain, deny, msg:\u0026#39;STOP\u0026#39;, status:500, id:5555\u0026#34; SecRule REQUEST_URI|ARGS|REQUEST_BODY \u0026#34;EPITA\u0026#34; \\  \u0026#34;log, auditlog, tag:\u0026#39;KeyWord_EPITA_matched\u0026#39;\u0026#34; On regarde si EPITA est présent après avoir regardé si on recevait une requête GET/POST/PUT. Le message d\u0026rsquo;erreur sera le 500 et l\u0026rsquo;évènement sera placé dans les logs. Tout se passe pendant la phase 2.\nRedémarrer apache :\n$ sudo systemctl restart apache2. OWASP ModSecurity Core Rule Set La Configuration par défaut ne suffisant pas, il est possible de se protéger en utilisant le CRS d\u0026rsquo;OWASP. OWASP CSR est à ce jour disponible par défaut avec l\u0026rsquo;installation de libapache2-mod-security.\nPour installer OWASP ModSecurity CRS manuellement il faut :\n  Cloner le dépôt du CRS :\n$ git clone https://github.com/SpiderLabs/owasp-modsecurity-crs.git   Inclure crs-setup.conf et rules/*.conf dans la configuration :\n /etc/apache2/mods-enabled/security2_module.    Redémarrer apache2.\n  MISP Snort Se rendre sur la page du gestionnaire de paquets de Pfsense, en cliquant sur l\u0026rsquo;onglet System, puis sur Package Manager :\n[[MISP_Screenshots/Snort/1]]{#MISP_Screenshots/Snort/1 label=\u0026ldquo;MISP_Screenshots/Snort/1\u0026rdquo;}\n[[MISP_Screenshots/Snort/2]]{#MISP_Screenshots/Snort/2 label=\u0026ldquo;MISP_Screenshots/Snort/2\u0026rdquo;}\nEntrer le mot-clé snort dans la barre de recherche de paquets :\n[[MISP_Screenshots/Snort/3]]{#MISP_Screenshots/Snort/3 label=\u0026ldquo;MISP_Screenshots/Snort/3\u0026rdquo;}\nConfirmer l\u0026rsquo;installation du paquet, en cliquant sur le bouton Confirm :\n[[MISP_Screenshots/Snort/4]]{#MISP_Screenshots/Snort/4 label=\u0026ldquo;MISP_Screenshots/Snort/4\u0026rdquo;}\nAttendre la fin de l\u0026rsquo;installation du paquet Snort :\n[[MISP_Screenshots/Snort/5]]{#MISP_Screenshots/Snort/5 label=\u0026ldquo;MISP_Screenshots/Snort/5\u0026rdquo;}\n[[MISP_Screenshots/Snort/6]]{#MISP_Screenshots/Snort/6 label=\u0026ldquo;MISP_Screenshots/Snort/6\u0026rdquo;}\nAfin d\u0026rsquo;accéder à la page du service Snort sur l\u0026rsquo;interface web de Pfsense, cliquer sur l\u0026rsquo;onglet Services, puis sur Snort :\n[[MISP_Screenshots/Snort/7]]{#MISP_Screenshots/Snort/7 label=\u0026ldquo;MISP_Screenshots/Snort/7\u0026rdquo;}\nAjouter une nouvelle interface WAN en cliquant sur le bouton Add :\n[[MISP_Screenshots/Snort/8]]{#MISP_Screenshots/Snort/8 label=\u0026ldquo;MISP_Screenshots/Snort/8\u0026rdquo;}\nConfigurer l\u0026rsquo;interface WAN, selon la capture d\u0026rsquo;écran suivante :\n[[MISP_Screenshots/Snort/9]]{#MISP_Screenshots/Snort/9 label=\u0026ldquo;MISP_Screenshots/Snort/9\u0026rdquo;}\nAjouter le chemin d\u0026rsquo;un fichier de configuration dans l\u0026rsquo;encadré Advanced Configuration Pass-Through. Le texte à écrire est donc : include /usr/local/etc/snort/rules/misp.rules :\n[[MISP_Screenshots/Snort/10]]{#MISP_Screenshots/Snort/10 label=\u0026ldquo;MISP_Screenshots/Snort/10\u0026rdquo;}\nDupliquer la configuration de l\u0026rsquo;interface WAN pour faire une interface LAN :\n[[MISP_Screenshots/Snort/11]]{#MISP_Screenshots/Snort/11 label=\u0026ldquo;MISP_Screenshots/Snort/11\u0026rdquo;}\nConfigurer la nouvelle interface LAN, tel que sur la capture d\u0026rsquo;écran suivante :\n[[MISP_Screenshots/Snort/12]]{#MISP_Screenshots/Snort/12 label=\u0026ldquo;MISP_Screenshots/Snort/12\u0026rdquo;}\nComme pour l\u0026rsquo;interface WAN, ajouter le chemin du fichier de configuration dans l\u0026rsquo;encadré Advanced Configuration Pass-Through : include/usr/local/etc/snort/rules/misp.rules :\n[[MISP_Screenshots/Snort/13]]{#MISP_Screenshots/Snort/13 label=\u0026ldquo;MISP_Screenshots/Snort/13\u0026rdquo;}\nDe la même manière que pour les interfaces WAN et LAN, créer une nouvelle interface pour la DMZ :\n[[MISP_Screenshots/Snort/14]]{#MISP_Screenshots/Snort/14 label=\u0026ldquo;MISP_Screenshots/Snort/14\u0026rdquo;}\nEncore une fois, ajouter le chemin du fichier de configuration dans l\u0026rsquo;encadré Advanced Configuration Pass-Through : include /usr/local/etc/snort/rules/misp.rules :\n[[MISP_Screenshots/Snort/15]]{#MISP_Screenshots/Snort/15 label=\u0026ldquo;MISP_Screenshots/Snort/15\u0026rdquo;}\nCliquer sur le bouton Play de chacune des interfaces, dans la colonne Snort Status.\n[[MISP_Screenshots/Snort/16]]{#MISP_Screenshots/Snort/16 label=\u0026ldquo;MISP_Screenshots/Snort/16\u0026rdquo;}\n[[MISP_Screenshots/Snort/17]]{#MISP_Screenshots/Snort/17 label=\u0026ldquo;MISP_Screenshots/Snort/17\u0026rdquo;}\nIptables C\u0026rsquo;est sur le serveur Web, situé dans la DMZ, que sont gérées les règles iptables. Celles-ci sont créées suite à la récupération de règles Snort de la plateforme MISP.\nUn script analysant ces règles Snort, et les traduisant en règles iptables a été créé. Ce script écrit en Python2.7 est décrit dans le document dev.pdf.\nSquid avec ClamAV L\u0026rsquo;installation et la configuration du proxy Squid ayant déjà été traitées dans le document archi1.pdf, il n\u0026rsquo;est pas nécessaire d\u0026rsquo;en reparler ici.\nLors de l\u0026rsquo;installation de Squid, l\u0026rsquo;antivirus ClamAV est également installé sur le Pfsense. Cet antivirus est capable de traiter des règles YARA, situées dans le dossier :\n/var/db/clamav/\nAussi, il est possible d\u0026rsquo;exporter des règles YARA, via la plateforme MISP, permettant de détecter des malwares ainsi que des outils d\u0026rsquo;attaques spécifique à APT17.\nPour cela, nous avons écrit un script Python2.7 utilisant la bibliothèque PyMISP, récupérant les attributs YARA, et les écrivant dans le fichier /var/db/clamav/rules.yara. Ce script est relancé toutes les heures à l\u0026rsquo;aide d\u0026rsquo;une tâche ajoutée avec crontab.\nCe script est décrit plus en détail dans le document dev.pdf.\nGraylog Les seules modifications à effectuer sont celles de la configuration réseau dans le fichier de configuration /etc/network/interfaces selon la figure 289{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;graylog_screenshots/1.png\u0026rdquo;}, et celles concernant le nom d\u0026rsquo;hôte dans /etc/hosts, tel que sur la figure 290{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;graylog_screenshots/2.png\u0026rdquo;}.\nIl suffira de redémarrer la machine virtuelle pour que les changements prennent effet avec la commande suivante : sudo reboot{.shell}\n{#graylog_screenshots/1.png}\n{#graylog_screenshots/2.png}\n  Ansible est une plate-forme logicielle libre pour la configuration et la gestion des ordinateurs. Elle combine le déploiement de logiciels multi nœuds, l\u0026rsquo;exécution des tâches ad-hoc, et la gestion de configuration. Elle gère les différents nœuds à travers SSH et ne nécessite l\u0026rsquo;installation d\u0026rsquo;aucun logiciel supplémentaire sur ceux-ci. Les modules communiquent via la sortie standard en notation JSON et peuvent être écrits dans n\u0026rsquo;importe quel langage de programmation. Le système utilise YAML pour exprimer des descriptions réutilisables de systèmes, appelés playbook - https://fr.wikipedia.org/wiki/Ansible_(logiciel)\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n Kerberos est un protocole réseau d\u0026rsquo;authentification. Il a été conçu pour apporter une authentification sûre pour un couple client/serveur en utilisant des clés de chiffrement. Il existe une implémentation gratuite de ce protocole par le MIT. Kerberos est aussi disponible dans plusieurs produits commerciaux - https://web.mit.edu/kerberos/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ModSecurity est un module qui s\u0026rsquo;intègre au serveur Web Apache et qui permet de mettre en place un pare-feu applicatif dédié aux applications Web. Il fournit un moteur permettant de détecter et de se prémunir des attaques avant qu\u0026rsquo;elles n\u0026rsquo;atteignent l\u0026rsquo;application Web protégée.\nModSecurity offre les mécanismes suivants :\n  la journalisation du trafic ;\n  la surveillance du trafic et détection en temps réel des attaques ;\n  la prévention des attaques et adaptation des règles de détection en vue de corriger les vulnérabilités applicatives sans modifier réellement les applications Web.\n  [@modsecurity]\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n OWASP ModSecurity Core Rule Set (CRS) est un ensemble de règles de détection d\u0026rsquo;attaques génériques à utiliser avec, entre autres, ModSecurity. Le CRS a pour but de protéger les applications contre une grande variété d\u0026rsquo;attaques, incluant le top 10 des attaques recensées par OWASP. De plus, il génère très peu de fausses alertes - https://modsecurity.org/crs/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n   "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/archi2/configuration/",
	"title": "Configuration de l&#39;architecture",
	"tags": [],
	"description": "",
	"content": "Kali Linux Mise à jour de Kali Linux Afin de pouvoir utiliser les outils de Kali Linux dans leur dernière version, lancer la commande suivante dans un terminal :\nsudo apt update Puis lancer la commande :\nsudo apt upgrade Enfin, valider le choix en entrant Y dans le prompt comme le montre la figure 32{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Kali/upgrade1\u0026rdquo;} ci-dessous.\n{#Kali/upgrade1}\nAttribution d\u0026rsquo;une adresse IPv4 statique Pour pouvoir être dans le sous-réseau avec une adresse IP statique, il faut :\n  Se rendre dans le dossier /etc/network et ouvrir le fichier interfaces comme le montre la figure 33{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Kali/interfaces\u0026rdquo;} ;\n{#Kali/interfaces}\n  Écrire à l\u0026rsquo;identique le contenu de la figure 34{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Kali/static\u0026rdquo;} ;\n{#Kali/static}\n  Redémarrer le service des interfaces réseau comme montré dans la figure 35{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Kali/service\u0026rdquo;} :\n{#Kali/service}\n  Mise en place du scanner applicatif Lancement des sessions de scan de vulnérabilités applicatives Afin de lancer Zap, cliquer sur Applications -\u0026gt; 03 - Web Application Analysis -\u0026gt; OWASP zap, comme le montre la figure 36{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/zap\u0026rdquo;} :\n{#Vuln/zap}\nIl suffira ensuite de rentrer une URL dans l\u0026rsquo;onglet Quick Start pour démarrer une analyse :\n{#Kali/upgrade}\nCréation d\u0026rsquo;un profil de scan Afin de ne cibler que les vulnérabilités voulues, Zap proxy permet de créer des profils personnalisés.\nPour cela, cliquer sur Analyse puis sur Scan Policy Manager... :\n{#Kali/upgrade}\nCliquer ensuite sur Add :\n{#Kali/upgrade}\nNommer le profil comme montré dans la figure 40{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/Nommage\u0026rdquo;} :\n{#Vuln/Nommage}\nConfigurer les injections comme montré dans la figure 41{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/Modifications\u0026rdquo;} :\n{#Vuln/Modifications}\nScan applicatif de l\u0026rsquo;interface du Pfsense À partir du menu de Zap, entrer l\u0026rsquo;URL de l\u0026rsquo;interface du Pfsense, puis cliquer sur Launch Browser. L\u0026rsquo;opération va ouvrir un navigateur modifié pour le scan applicatif. La figure 42{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/Navigateur\u0026rdquo;} montre le navigateur modifié. Cliquer sur l\u0026rsquo;icône représentant une flamme pour passer en scan actif :\n{#Vuln/Navigateur}\nCliquer Turn On :\n{#Kali/upgrade}\nAttendre que le scan termine :\n{#Kali/upgrade}\nScan applicatif de l\u0026rsquo;interface du MISP Comme pour l\u0026rsquo;analyse du Pfsense, lancer Zap sur l\u0026rsquo;URL de l\u0026rsquo;interface MISP.\nAfin de pouvoir avoir un scan applicatif efficace, il faut s\u0026rsquo;authentifier sur l\u0026rsquo;interface du MISP comme le montre la figure 45{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/Misp\u0026rdquo;} :\n{#Vuln/Misp}\nCliquer sur l\u0026rsquo;icône représentant une flamme pour passer en scan actif puis cliquer sur Start pour lancer le scan :\n{#Kali/upgrade}\nGénérer les exports de OWASP Zap Afin de pouvoir exporter les résultats des scans, il suffit de :\n  Cliquer sur le menu Report puis sur Generate HTML Report... ;\n{#Kali/upgrade}\n  Nommer l\u0026rsquo;export puis cliquer sur Save ;\n{#Kali/upgrade}\n  Pour consulter le rapport, double-cliquer sur celui-ci.\nLa figure 49{reference-type=\u0026ldquo;ref\u0026rdquo; reference=\u0026ldquo;Vuln/Rapport\u0026rdquo;} montre un aperçu d\u0026rsquo;un rapport d\u0026rsquo;analyse applicative via le logiciel Zap Proxy :\n{#Vuln/Rapport}\n  Windows 8.1 Attribution des paramètres réseaux Démarrer la machine virtuelle Windows 8.1. Accéder aux paramètres réseau et Internet, en cliquant droit sur l\u0026rsquo;icône de réseau sur la droite de la barre des tâches. Cliquer sur Ouvrir le Centre Réseau et partage :\n{#Windows8_screenshots/Config/1}\nDans le panel de gauche, cliquer sur Modifier les paramètres de la carte :\n{#Windows8_screenshots/Config/2}\nCliquer droit sur la carte Ethernet, et sélectionner Propriétés :\n{#Windows8_screenshots/Config/3}\nDécocher Protocole Internet version 6 (TCP/IPv6), et cocher Protocole Internet version 4 (TCP/IPv4). Cliquer sur Propriétés pour IPv4 :\n{#Windows8_screenshots/Config/4}\nRenseigner la valeur du serveur DNS préféré : 192.168.2.2. Cliquer sur OK :\n{#Windows8_screenshots/Config/5}\nAttribution du domaine Accéder aux paramètres Système :\n{#Windows8_screenshots/Config/6}\nCliquer sur Modifier les paramètres :\n{#Windows8_screenshots/Config/7}\nAccéder aux propriétés de domaine en cliquant sur Modifier :\n{#Windows8_screenshots/Config/8}\nSélectionner \u0026quot;Membre d\u0026rsquo;un domaine\u0026quot;, puis entrer le nom du domaine à intégrer. Ici, EPITAF.local, puis cliquer sur OK :\n{#Windows8_screenshots/Config/9}\nEntrer les identifiants demandés, puis cliquer sur OK :\n{#Windows8_screenshots/Config/10}\nUn message de bienvenue apparaît si les identifiants sont corrects. Cliquer sur OK pour fermer toutes les fenêtres.\n{#Windows8_screenshots/Config/11}\nCliquer sur Redémarrer maintenant pour redémarrer le PC Windows 8.1, afin que le changement de domaine soit effectif :\n{#Windows8_screenshots/Config/12}\nInstallation de MBSA Pour en savoir plus sur MBSA, se réferrer au document microsoft.pdf.\\\nSur Windows 8.1 Il est possible d\u0026rsquo;installer la version 2.3 du logiciel MBSA sur la machine Windows 8.1. Cette version de l\u0026rsquo;exécutable n\u0026rsquo;est pas disponible sur le site officiel de Microsoft. Elle est toutefois disponible à l\u0026rsquo;url suivante : https://www.clubic.com/telecharger-fiche123308-microsoft-baseline-security-analyzer.html\nCliquer sur Enregistrer le fichier pour enregistrer l\u0026rsquo;exécutable d\u0026rsquo;installation du logiciel MBSA :\n{#MBSA_screenshots/Install-Win8/3}\nUne fois téléchargé, double-cliquer sur l\u0026rsquo;exécutable pour lancer la procédure d\u0026rsquo;installation.\nCliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-Win8/4}\nSélectionner l\u0026rsquo;option \u0026quot;J\u0026rsquo;accepte le contrat de licence\u0026quot;. Cliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-Win8/5}\nChoisir un dossier de destination, puis cliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-Win8/6}\nCliquer sur Installer :\n{#MBSA_screenshots/Install-Win8/7}\nPatienter pendant l\u0026rsquo;installation du logiciel MBSA :\n{#MBSA_screenshots/Install-Win8/8}\nAfin de finaliser l\u0026rsquo;installation, cliquer sur OK :\n{#MBSA_screenshots/Install-Win8/9}\nSur Windows Server 2012 Il est possible d\u0026rsquo;installer la version 2.1.1 du logiciel MBSA sur la machine Windows Server 2012. L\u0026rsquo;exécutable est disponible sur le site web de Microsoft, à l\u0026rsquo;url suivante : https://www.microsoft.com/fr-fr/download/details.aspx?id=19892\nSélectionner la langue, puis cliquer sur Télécharger :\n{#MBSA_screenshots/Install-WS/1}\nSélectionner l\u0026rsquo;exécutable en fonction de la plateforme ; ici, le fichier MBSASetup-x64-FR.msi, puis cliquer sur Next :\n{#MBSA_screenshots/Install-WS/2}\nCliquer sur Enregistrer le fichier pour enregistrer l\u0026rsquo;exécutable d\u0026rsquo;installation du logiciel MBSA :\n{#MBSA_screenshots/Install-WS/34}\nUne fois téléchargé, double-cliquer sur l\u0026rsquo;exécutable pour lancer la procédure d\u0026rsquo;installation.\\\nCliquer sur Exécuter :\n{#MBSA_screenshots/Install-WS/35}\nCliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-WS/36}\nSélectionner l\u0026rsquo;option \u0026quot;J\u0026rsquo;accepte le contrat de licence\u0026quot;. Cliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-WS/37}\nChoisir un dossier de destination, puis cliquer sur Suivant \u0026gt; :\n{#MBSA_screenshots/Install-WS/38}\nCliquer sur Installer :\n{#MBSA_screenshots/Install-WS/39}\nAfin de finaliser l\u0026rsquo;installation, cliquer sur OK :\n{#MBSA_screenshots/Install-WS/40}\nInstallation de nouveaux rôles et fonctionnalités Installation des fonctionnalités IIS et WSUS dans le cadre du logiciel MBSA.\nDémarrer la machine virtuelle Windows Server 2012. Ouvrir le gestionnaire de serveur (s\u0026rsquo;ouvre normalement automatiquement lors du démarrage de la machine). Cliquer sur l\u0026rsquo;onglet Gérer, puis sur Ajouter des rôles et fonctionnalités :\n{#WS_Screenshots/Features_install/22}\nAller dans la section Avant de commencer, puis cliquer sur Suivant :\n{#WS_Screenshots/Features_install/23}\nAller dans la section Type d\u0026rsquo;installation, sélectionner la première option \u0026quot;Installation basée sur un rôle ou une fonctionnalité\u0026quot;, puis cliquer sur Suivant :\n{#WS_Screenshots/Features_install/24}\nAller dans la section Sélection du serveur. Cocher l\u0026rsquo;option \u0026quot;Sélectionner un serveur de pool de serveurs\u0026quot;. Choisir DC01.EPITAF.local, puis cliquer sur Suivant :\n{#WS_Screenshots/Features_install/25}\nAller dans la section Rôles de serveurs. Cocher les options : \u0026quot;Serveur FTP\u0026quot; du Serveur Web (IIS) et \u0026quot;Services WSUS\u0026quot;. Cliquer sur Suivant, puis cliquer sur Ajouter des fonctionnalités :\n{#WS_Screenshots/Features_install/26}\nCliquer sur Ajouter des fonctionnalités :\n{#WS_Screenshots/Features_install/27}\nAller dans la section Fonctionnalités. Cliquer sur Suivant \u0026gt; :\n{#WS_Screenshots/Features_install/28}\nAller dans la section WSUS. Cliquer sur Suivant :\n{#WS_Screenshots/Features_install/29}\nDans la section Services de rôles, cocher \u0026quot;WID Database\u0026quot; ainsi que \u0026quot;WSUS Services\u0026quot;. Cliquer sur Suivant :\n{#WS_Screenshots/Features_install/30}\nDans la section Contenu, renseigner un chemin pour stocker les mises à jour, tel que sur la capture d\u0026rsquo;écran ci-après, puis cliquer sur Suivant :\n{#WS_Screenshots/Features_install/31}\nAller dans la section Confirmation. Cliquer sur Installer :\n{#WS_Screenshots/Features_install/32}\nAller dans la section Résultats, et attendre la fin de l\u0026rsquo;installation. Cliquer sur Fermer une fois terminé :\n{#WS_Screenshots/Features_install/33}\nUne fois l\u0026rsquo;installation terminée, accepter le redémarrage du serveur.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/analyse/partie3/",
	"title": "Partie 3",
	"tags": [],
	"description": "",
	"content": "Comparaison des produits OpenVAS, Nessus et Nexpose  nnalité | OpenVAS |Nessus |Nexpose|\nà des normes | Non | Oui | Oui|\nvulnérabilités dans le temps | Oui | Oui | Oui|\nla licence GNU General Public License (GNU GPL) Network. Version d\u0026rsquo;essai gratuite pour utilisation non commerciale. Période limitée Version d\u0026rsquo;essai de 30 jours gratuite\nvulnérabilités que d\u0026rsquo;autres outils. Support limité des systèmes d\u0026rsquo;exploitation par an. Expertise sur cet outil nécessaire important de faux-positifs Oui Oui Oui\nde scans sans dépendance à Internet Non Oui Oui\n "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/microsoft/",
	"title": "Microsoft",
	"tags": [],
	"description": "",
	"content": "Microsoft Microsoft Baseline Security Analyzer Le logiciel MBSA - Microsoft Baseline Security Analyzer est un outil de Microsoft. Cet outil est utilisé pour vérifier le niveau de patches du système par rapport au référentiel de sécurité. Lors d\u0026rsquo;une analyse, MBSA fait également des vérifications concernant les mauvaises configurations de sécurité pour Windows, IIS (Internet Information Services) et SQL Server.\nIl existe une version 2.3 de MBSA, qui permet la compatibilité avec Windows 8 et Windows 8.1. Cependant, MBSA est devenu obsolète, et n\u0026rsquo;est plus maintenu ; d\u0026rsquo;où la non-compatibilité avec Windows 10 et Windows Server 2016.\nLa procédure d\u0026rsquo;installation de ce logiciel est détaillée dans le document archi2.pdf, en partie 7.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/dev/",
	"title": "Dev",
	"tags": [],
	"description": "",
	"content": "DEV Introduction La présente documentation a été écrite dans le but de faciliter la prise en main du script PowerShell, ainsi que son exécution.\nDans un premier temps, l\u0026rsquo;environnement nécessaire à la bonne exécution du script est décrit. Dans un deuxième temps, le script écrit pour ce travail sera documenté afin d\u0026rsquo;expliquer son fonctionnement.\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/microsoft_annexe/",
	"title": "Annexes",
	"tags": [],
	"description": "",
	"content": "DEV  Exécution d\u0026rsquo;un déploiement de MBSA\n"
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/questions_r%C3%A9ponses/",
	"title": "Q&amp;A",
	"tags": [],
	"description": "",
	"content": "Questions et réponses  "
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://QXNzaXN0YW50c1NSUw.github.io/DM2.0_DEMO/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]